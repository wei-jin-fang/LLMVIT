Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../../data/3Train.csv每一类的数量是: [15640, 2160]
../../../data/3Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../../data/3Val.csv每一类的数量是: [6640, 880]
../../../data/3Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../../data/3Test.csv每一类的数量是: [5600, 1400]
../../../data/3Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
train_x.shape : (445, 40, 10) 
train_y.shape : (445,) 
validate_x.shape : (188, 40, 10) 
validate_y.shape : (188,) 
test_x.shape : (175, 40, 10) 
test_y.shape : (175,) 
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=80, epochs=200, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=2, num_hidden_layers=4, num_layers=2, optim='Adam', print=0, seed=2021)
====================数据集3测试集轮评估数据=============================================
正在计算样本 0 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.6884876360785928
==============验证=======================模型实际输出（正类）: [[-0.7221334  -0.66497767]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.502335208519618
==============验证=======================模型输出概率: [[0.48571494 0.514285  ]]
正在计算样本 1 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -1.169609135863944
==============验证=======================模型实际输出（正类）: [[-0.3641214 -1.1868105]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.31048827628305176
==============验证=======================模型输出概率: [[0.6948068  0.30519316]]
正在计算样本 2 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.8780163132998269
==============验证=======================模型实际输出（正类）: [[-0.5171833 -0.9068295]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.4156065276548911
==============验证=======================模型输出概率: [[0.5961975  0.40380245]]
正在计算样本 3 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.7573720503525663
==============验证=======================模型实际输出（正类）: [[-0.5940788 -0.8031204]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.4688970471275046
==============验证=======================模型输出概率: [[0.5520709  0.44792908]]
正在计算样本 4 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.8381512394965568
==============验证=======================模型实际输出（正类）: [[-0.562464  -0.8435129]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.4325093910236058
==============验证=======================模型输出概率: [[0.56980336 0.43019664]]
正在计算样本 5 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.7760202276877405
==============验证=======================模型实际输出（正类）: [[-0.6174744 -0.7750187]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.4602339979293398
==============验证=======================模型输出概率: [[0.5393048  0.46069515]]
正在计算样本 6 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.3406784640083641
==============验证=======================模型实际输出（正类）: [[-1.173712   -0.36992958]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.7112875759980639
==============验证=======================模型输出概率: [[0.309217   0.69078296]]
正在计算样本 7 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.6685911983325517
==============验证=======================模型实际输出（正类）: [[-0.8106172  -0.58803713]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.5124299817223941
==============验证=======================模型输出概率: [[0.4445836 0.5554164]]
正在计算样本 8 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.9584079040801569
==============验证=======================模型实际输出（正类）: [[-0.4725725 -0.9765623]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.3835029737068349
==============验证=======================模型输出概率: [[0.6233965 0.3766035]]
正在计算样本 9 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.7861802431837974
==============验证=======================模型实际输出（正类）: [[-0.6784052  -0.70810974]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.455581687173104
==============验证=======================模型输出概率: [[0.5074256  0.49257442]]
正在计算样本 10 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.4590712129508234
==============验证=======================模型实际输出（正类）: [[-1.0231937 -0.4454205]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.6318702459525092
==============验证=======================模型输出概率: [[0.35944512 0.64055485]]
正在计算样本 11 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.8986403398247674
==============验证=======================模型实际输出（正类）: [[-0.5432209 -0.8695843]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.4071228322935317
==============验证=======================模型输出概率: [[0.5808743  0.41912574]]
正在计算样本 12 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -1.13232939047115
==============验证=======================模型实际输出（正类）: [[-0.4008851 -1.1078358]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.3222816615516931
==============验证=======================模型输出概率: [[0.669727   0.33027297]]
正在计算样本 13 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.29404639018280065
==============验证=======================模型实际输出（正类）: [[-1.5103481  -0.24953003]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.745241918732537
==============验证=======================模型输出概率: [[0.22083308 0.7791669 ]]
正在计算样本 14 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -1.1027850096918448
==============验证=======================模型实际输出（正类）: [[-0.40155208 -1.1064845 ]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.33194532422676615
==============验证=======================模型输出概率: [[0.66928047 0.33071953]]
正在计算样本 15 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.7730205189546937
==============验证=======================模型实际输出（正类）: [[-0.58623874 -0.81286836]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.4616166385950342
==============验证=======================模型输出概率: [[0.55641615 0.44358388]]
正在计算样本 16 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -1.1618458122268427
==============验证=======================模型实际输出（正类）: [[-0.37010086 -1.1733294 ]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.3129080779558454
==============验证=======================模型输出概率: [[0.69066465 0.30933532]]
正在计算样本 17 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.6453290928613875
==============验证=======================模型实际输出（正类）: [[-0.67209285 -0.7146544 ]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.5244899078172623
==============验证=======================模型输出概率: [[0.5106388 0.4893612]]
正在计算样本 18 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.29826566355218465
==============验证=======================模型实际输出（正类）: [[-1.3468995  -0.30116624]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.7421041635294925
==============验证=======================模型输出概率: [[0.2600453  0.73995477]]
正在计算样本 19 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -1.0933897583045487
==============验证=======================模型实际输出（正类）: [[-0.42114723 -1.0679669 ]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.3350787305156293
==============验证=======================模型输出概率: [[0.6562935 0.3437066]]
正在计算样本 20 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.9002090495804547
==============验证=======================模型实际输出（正类）: [[-0.4968186 -0.9376762]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.4064846754070839
==============验证=======================模型输出概率: [[0.6084633  0.39153662]]
正在计算样本 21 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.7966033508300832
==============验证=======================模型实际输出（正类）: [[-0.61177695 -0.78172964]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.45085777191222415
==============验证=======================模型输出概率: [[0.5423862  0.45761383]]
正在计算样本 22 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.06095402513020298
==============验证=======================模型实际输出（正类）: [[-4.382392  -0.0125742]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.9408664949962794
==============验证=======================模型输出概率: [[0.01249543 0.98750454]]
正在计算样本 23 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.7567870866131975
==============验证=======================模型实际输出（正类）: [[-0.6365881 -0.753098 ]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.4691714151374161
==============验证=======================模型输出概率: [[0.5290945  0.47090542]]
正在计算样本 24 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.9496314907391559
==============验证=======================模型实际输出（正类）: [[-0.48378593 -0.9582726 ]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.38688356736595514
==============验证=======================模型输出概率: [[0.6164451  0.38355488]]
正在计算样本 25 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.32559322378920275
==============验证=======================模型实际输出（正类）: [[-1.0743923  -0.41779867]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.7220988603363193
==============验证=======================模型输出概率: [[0.34150523 0.6584948 ]]
正在计算样本 26 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.41295673406614775
==============验证=======================模型实际输出（正类）: [[-0.991561  -0.4636194]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.661690910883715
==============验证=======================模型输出概率: [[0.3709971 0.6290029]]
正在计算样本 27 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.8931707679884275
==============验证=======================模型实际输出（正类）: [[-0.47299773 -0.975859  ]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.4093557207763265
==============验证=======================模型输出概率: [[0.6231315  0.37686846]]
正在计算样本 28 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -1.8463027211727276
==============验证=======================模型实际输出（正类）: [[-0.1757555 -1.8252525]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.15781959199108866
==============验证=======================模型输出概率: [[0.8388231  0.16117695]]
正在计算样本 29 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -1.0902666836875397
==============验证=======================模型实际输出（正类）: [[-0.40946126 -1.0906675 ]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.33612684220720757
==============验证=======================模型输出概率: [[0.6640079  0.33599216]]
正在计算样本 30 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.7010724117054818
==============验证=======================模型实际输出（正类）: [[-0.65640616 -0.7312898 ]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.49605304534995587
==============验证=======================模型输出概率: [[0.51871216 0.48128784]]
正在计算样本 31 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.3714895895886968
==============验证=======================模型实际输出（正类）: [[-1.0489974 -0.4312272]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.6897061859168281
==============验证=======================模型输出概率: [[0.35028878 0.64971125]]
正在计算样本 32 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -1.222576151533972
==============验证=======================模型实际输出（正类）: [[-0.34207043 -1.2389032 ]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.29447058809178733
==============验证=======================模型输出概率: [[0.7102981  0.28970182]]
正在计算样本 33 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -1.1735060818658227
==============验证=======================模型实际输出（正类）: [[-0.3824574 -1.1462795]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.3092806747433945
==============验证=======================模型输出概率: [[0.68218297 0.317817  ]]
正在计算样本 34 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -1.2092737855098326
==============验证=======================模型实际输出（正类）: [[-0.3189523 -1.2979546]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.2984139132669328
==============验证=======================模型输出概率: [[0.7269102 0.2730898]]
正在计算样本 35 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.7352752563488942
==============验证=======================模型实际输出（正类）: [[-0.67219573 -0.7145469 ]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.47937349021643433
==============验证=======================模型输出概率: [[0.51058626 0.4894138 ]]
正在计算样本 36 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -1.077260260483381
==============验证=======================模型实际输出（正类）: [[-0.42331335 -1.063844  ]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.3405272046222926
==============验证=======================模型输出概率: [[0.6548734 0.3451266]]
正在计算样本 37 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -0.33571086662316996
==============验证=======================模型实际输出（正类）: [[-1.1122333  -0.39872357]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.7148297570812521
==============验证=======================模型输出概率: [[0.32882378 0.6711762 ]]
正在计算样本 38 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -1.0836558822479005
==============验证=======================模型实际输出（正类）: [[-0.4104474 -1.0887216]]
==============验证=======================预测概率（基线值 + SHAP 值）: 0.33835627105596217
==============验证=======================模型输出概率: [[0.6633534 0.3366466]]
正在计算样本 39 的 SHAP 值...
==============验证=======================基线值 + SHAP 值之和: -1.294714052435696
==============验证=======================模型实际输出（正类）: [[-0.3043401 -1.3379232]]
