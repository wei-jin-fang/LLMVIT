Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/0Train.csv每一类的数量是: [15640, 2160]
../../data/0Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/0Val.csv每一类的数量是: [6640, 880]
../../data/0Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/0Test.csv每一类的数量是: [5600, 1400]
../../data/0Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集0测试集轮评估数据=============================================
[[119  21]
 [  6  29]]
TSS: 0.6785714285714286
本轮评估完成 
Test set: Average loss: 7.4503, Accuracy: 148/175 (85%)

[[119  21]
 [  6  29]]
Recall [0.85       0.82857143]
Precision [0.952 0.58 ]
Accuracy [0.84571429 0.84571429]
TSS [0.67857143 0.67857143]
HSS [0.58461538 0.58461538]
FAR [0.048 0.42 ]
data_FPR [0.17142857 0.15      ]
BS, BSS [0.14023716646169618, 0.12351770961439734]
数据集 0 测试集BSS: 0.12351770961439734
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/1Train.csv每一类的数量是: [15640, 2160]
../../data/1Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/1Val.csv每一类的数量是: [6640, 880]
../../data/1Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/1Test.csv每一类的数量是: [5600, 1400]
../../data/1Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集1测试集轮评估数据=============================================
[[123  17]
 [  3  32]]
TSS: 0.7928571428571428
本轮评估完成 
Test set: Average loss: 7.4605, Accuracy: 155/175 (89%)

[[123  17]
 [  3  32]]
Recall [0.87857143 0.91428571]
Precision [0.97619048 0.65306122]
Accuracy [0.88571429 0.88571429]
TSS [0.79285714 0.79285714]
HSS [0.68944099 0.68944099]
FAR [0.02380952 0.34693878]
data_FPR [0.08571429 0.12142857]
BS, BSS [0.14073438434875343, 0.12041009782028955]
数据集 1 测试集BSS: 0.12041009782028955
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/2Train.csv每一类的数量是: [15640, 2160]
../../data/2Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/2Val.csv每一类的数量是: [6640, 880]
../../data/2Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/2Test.csv每一类的数量是: [5600, 1400]
../../data/2Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集2测试集轮评估数据=============================================
[[116  24]
 [  2  33]]
TSS: 0.7714285714285715
本轮评估完成 
Test set: Average loss: 7.5173, Accuracy: 149/175 (85%)

[[116  24]
 [  2  33]]
Recall [0.82857143 0.94285714]
Precision [0.98305085 0.57894737]
Accuracy [0.85142857 0.85142857]
TSS [0.77142857 0.77142857]
HSS [0.62427746 0.62427746]
FAR [0.01694915 0.42105263]
data_FPR [0.05714286 0.17142857]
BS, BSS [0.139528440155615, 0.12794724902740473]
数据集 2 测试集BSS: 0.12794724902740473
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/3Train.csv每一类的数量是: [15640, 2160]
../../data/3Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/3Val.csv每一类的数量是: [6640, 880]
../../data/3Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/3Test.csv每一类的数量是: [5600, 1400]
../../data/3Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集3测试集轮评估数据=============================================
[[105  35]
 [  5  30]]
TSS: 0.6071428571428571
本轮评估完成 
Test set: Average loss: 7.7152, Accuracy: 135/175 (77%)

[[105  35]
 [  5  30]]
Recall [0.75       0.85714286]
Precision [0.95454545 0.46153846]
Accuracy [0.77142857 0.77142857]
TSS [0.60714286 0.60714286]
HSS [0.45945946 0.45945946]
FAR [0.04545455 0.53846154]
data_FPR [0.14285714 0.25      ]
BS, BSS [0.15475982895190862, 0.03275106905056946]
数据集 3 测试集BSS: 0.03275106905056946
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/4Train.csv每一类的数量是: [15640, 2160]
../../data/4Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/4Val.csv每一类的数量是: [6640, 880]
../../data/4Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/4Test.csv每一类的数量是: [5600, 1400]
../../data/4Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集4测试集轮评估数据=============================================
[[118  22]
 [  3  32]]
TSS: 0.7571428571428571
本轮评估完成 
Test set: Average loss: 6.9444, Accuracy: 150/175 (86%)

[[118  22]
 [  3  32]]
Recall [0.84285714 0.91428571]
Precision [0.97520661 0.59259259]
Accuracy [0.85714286 0.85714286]
TSS [0.75714286 0.75714286]
HSS [0.62908012 0.62908012]
FAR [0.02479339 0.40740741]
data_FPR [0.08571429 0.15714286]
BS, BSS [0.1263847747558113, 0.21009515777617793]
数据集 4 测试集BSS: 0.21009515777617793
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/5Train.csv每一类的数量是: [15640, 2160]
../../data/5Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/5Val.csv每一类的数量是: [6640, 880]
../../data/5Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/5Test.csv每一类的数量是: [5600, 1400]
../../data/5Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集5测试集轮评估数据=============================================
[[125  15]
 [  6  29]]
TSS: 0.7214285714285715
本轮评估完成 
Test set: Average loss: 6.5283, Accuracy: 154/175 (88%)

[[125  15]
 [  6  29]]
Recall [0.89285714 0.82857143]
Precision [0.95419847 0.65909091]
Accuracy [0.88 0.88]
TSS [0.72142857 0.72142857]
HSS [0.65798046 0.65798046]
FAR [0.04580153 0.34090909]
data_FPR [0.17142857 0.10714286]
BS, BSS [0.12060726899428827, 0.24620456878569708]
数据集 5 测试集BSS: 0.24620456878569708
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/6Train.csv每一类的数量是: [15640, 2160]
../../data/6Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/6Val.csv每一类的数量是: [6640, 880]
../../data/6Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/6Test.csv每一类的数量是: [5600, 1400]
../../data/6Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集6测试集轮评估数据=============================================
[[124  16]
 [  8  27]]
TSS: 0.6571428571428571
本轮评估完成 
Test set: Average loss: 6.0401, Accuracy: 151/175 (86%)

[[124  16]
 [  8  27]]
Recall [0.88571429 0.77142857]
Precision [0.93939394 0.62790698]
Accuracy [0.86285714 0.86285714]
TSS [0.65714286 0.65714286]
HSS [0.60526316 0.60526316]
FAR [0.06060606 0.37209302]
data_FPR [0.22857143 0.11428571]
BS, BSS [0.10964485729780324, 0.3147196418887286]
数据集 6 测试集BSS: 0.3147196418887286
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/7Train.csv每一类的数量是: [15640, 2160]
../../data/7Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/7Val.csv每一类的数量是: [6640, 880]
../../data/7Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/7Test.csv每一类的数量是: [5600, 1400]
../../data/7Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集7测试集轮评估数据=============================================
[[122  18]
 [  6  29]]
TSS: 0.7000000000000001
本轮评估完成 
Test set: Average loss: 7.5910, Accuracy: 151/175 (86%)

[[122  18]
 [  6  29]]
Recall [0.87142857 0.82857143]
Precision [0.953125   0.61702128]
Accuracy [0.86285714 0.86285714]
TSS [0.7 0.7]
HSS [0.62025316 0.62025316]
FAR [0.046875   0.38297872]
data_FPR [0.17142857 0.12857143]
BS, BSS [0.1408651296453477, 0.11959293971657536]
数据集 7 测试集BSS: 0.11959293971657536
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/8Train.csv每一类的数量是: [15640, 2160]
../../data/8Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/8Val.csv每一类的数量是: [6640, 880]
../../data/8Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/8Test.csv每一类的数量是: [5600, 1400]
../../data/8Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集8测试集轮评估数据=============================================
[[118  22]
 [  5  30]]
TSS: 0.7
本轮评估完成 
Test set: Average loss: 7.2740, Accuracy: 148/175 (85%)

[[118  22]
 [  5  30]]
Recall [0.84285714 0.85714286]
Precision [0.95934959 0.57692308]
Accuracy [0.84571429 0.84571429]
TSS [0.7 0.7]
HSS [0.59214502 0.59214502]
FAR [0.04065041 0.42307692]
data_FPR [0.14285714 0.15714286]
BS, BSS [0.1337276957035809, 0.16420190185261796]
数据集 8 测试集BSS: 0.16420190185261796
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/9Train.csv每一类的数量是: [15640, 2160]
../../data/9Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/9Val.csv每一类的数量是: [6640, 880]
../../data/9Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/9Test.csv每一类的数量是: [5600, 1400]
../../data/9Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集9测试集轮评估数据=============================================
[[112  28]
 [  3  32]]
TSS: 0.7142857142857143
本轮评估完成 
Test set: Average loss: 7.9992, Accuracy: 144/175 (82%)

[[112  28]
 [  3  32]]
Recall [0.8        0.91428571]
Precision [0.97391304 0.53333333]
Accuracy [0.82285714 0.82285714]
TSS [0.71428571 0.71428571]
HSS [0.56338028 0.56338028]
FAR [0.02608696 0.46666667]
data_FPR [0.08571429 0.2       ]
BS, BSS [0.1522729871292724, 0.04829383044204594]
数据集 9 测试集BSS: 0.04829383044204594
#接下来计算所有测试集指标均值和方法
[[1182  218]
 [  47  303]]
[[0.14023716646169618, 0.12351770961439734], [0.14073438434875343, 0.12041009782028955], [0.139528440155615, 0.12794724902740473], [0.15475982895190862, 0.03275106905056946], [0.1263847747558113, 0.21009515777617793], [0.12060726899428827, 0.24620456878569708], [0.10964485729780324, 0.3147196418887286], [0.1408651296453477, 0.11959293971657536], [0.1337276957035809, 0.16420190185261796], [0.1522729871292724, 0.04829383044204594]]
结果已写入 ./model_output/2024-11-03-20-41-02/results.xlsx
程序运行时间: 0.12 分钟
