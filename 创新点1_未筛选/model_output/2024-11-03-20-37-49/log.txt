Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='NN', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/0Train.csv每一类的数量是: [15640, 2160]
../../data/0Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/0Val.csv每一类的数量是: [6640, 880]
../../data/0Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/0Test.csv每一类的数量是: [5600, 1400]
../../data/0Test.csvget_Class函数得到的的权重： [0.625, 2.5]
train_x.shape : (17800, 10) 
train_y.shape : (17800,) 
validate_x.shape : (7520, 10) 
validate_y.shape : (7520,) 
test_x.shape : (7000, 10) 
test_y.shape : (7000,) 
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集0测试集轮评估数据=============================================
[[4846  754]
 [ 551  849]]
TSS: 0.47178571428571425
本轮评估完成 
Test set: Average loss: 7.3909, Accuracy: 5695/7000 (81%)

[[4846  754]
 [ 551  849]]
Recall [0.86535714 0.60642857]
Precision [0.89790624 0.52963194]
Accuracy [0.81357143 0.81357143]
TSS [0.47178571 0.47178571]
HSS [0.44745533 0.44745533]
FAR [0.10209376 0.47036806]
BS, BSS [0.14452878206905506, 0.0966951120684062]
数据集 0 测试集TSS: 0.47178571428571425
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='NN', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/1Train.csv每一类的数量是: [15640, 2160]
../../data/1Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/1Val.csv每一类的数量是: [6640, 880]
../../data/1Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/1Test.csv每一类的数量是: [5600, 1400]
../../data/1Test.csvget_Class函数得到的的权重： [0.625, 2.5]
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集1测试集轮评估数据=============================================
[[5045  555]
 [ 344 1056]]
TSS: 0.6551785714285715
本轮评估完成 
Test set: Average loss: 7.1039, Accuracy: 6101/7000 (87%)

[[5045  555]
 [ 344 1056]]
Recall [0.90089286 0.75428571]
Precision [0.93616626 0.65549348]
Accuracy [0.87157143 0.87157143]
TSS [0.65517857 0.65517857]
HSS [0.62013014 0.62013014]
FAR [0.06383374 0.34450652]
BS, BSS [0.13546270829225188, 0.1533580731734261]
数据集 1 测试集TSS: 0.6551785714285715
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='NN', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/2Train.csv每一类的数量是: [15640, 2160]
../../data/2Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/2Val.csv每一类的数量是: [6640, 880]
../../data/2Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/2Test.csv每一类的数量是: [5600, 1400]
../../data/2Test.csvget_Class函数得到的的权重： [0.625, 2.5]
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集2测试集轮评估数据=============================================
[[4803  797]
 [ 336 1064]]
TSS: 0.6176785714285714
本轮评估完成 
Test set: Average loss: 7.6387, Accuracy: 5867/7000 (84%)

[[4803  797]
 [ 336 1064]]
Recall [0.85767857 0.76      ]
Precision [0.93461763 0.57173563]
Accuracy [0.83814286 0.83814286]
TSS [0.61767857 0.61767857]
HSS [0.5497894 0.5497894]
FAR [0.06538237 0.42826437]
BS, BSS [0.1462501588592004, 0.0859365071299979]
数据集 2 测试集TSS: 0.6176785714285714
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='NN', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/3Train.csv每一类的数量是: [15640, 2160]
../../data/3Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/3Val.csv每一类的数量是: [6640, 880]
../../data/3Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/3Test.csv每一类的数量是: [5600, 1400]
../../data/3Test.csvget_Class函数得到的的权重： [0.625, 2.5]
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集3测试集轮评估数据=============================================
[[4951  649]
 [ 416  984]]
TSS: 0.5869642857142857
本轮评估完成 
Test set: Average loss: 7.3785, Accuracy: 5935/7000 (85%)

[[4951  649]
 [ 416  984]]
Recall [0.88410714 0.70285714]
Precision [0.92248929 0.60257195]
Accuracy [0.84785714 0.84785714]
TSS [0.58696429 0.58696429]
HSS [0.5524834 0.5524834]
FAR [0.07751071 0.39742805]
BS, BSS [0.1413550472218122, 0.11653095486367415]
数据集 3 测试集TSS: 0.5869642857142857
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='NN', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/4Train.csv每一类的数量是: [15640, 2160]
../../data/4Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/4Val.csv每一类的数量是: [6640, 880]
../../data/4Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/4Test.csv每一类的数量是: [5600, 1400]
../../data/4Test.csvget_Class函数得到的的权重： [0.625, 2.5]
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集4测试集轮评估数据=============================================
[[4701  899]
 [ 279 1121]]
TSS: 0.6401785714285714
本轮评估完成 
Test set: Average loss: 8.2607, Accuracy: 5822/7000 (83%)

[[4701  899]
 [ 279 1121]]
Recall [0.83946429 0.80071429]
Precision [0.9439759 0.5549505]
Accuracy [0.83171429 0.83171429]
TSS [0.64017857 0.64017857]
HSS [0.54900459 0.54900459]
FAR [0.0560241 0.4450495]
BS, BSS [0.15794804833932416, 0.012824697879224356]
数据集 4 测试集TSS: 0.6401785714285714
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='NN', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/5Train.csv每一类的数量是: [15640, 2160]
../../data/5Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/5Val.csv每一类的数量是: [6640, 880]
../../data/5Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/5Test.csv每一类的数量是: [5600, 1400]
../../data/5Test.csvget_Class函数得到的的权重： [0.625, 2.5]
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集5测试集轮评估数据=============================================
[[5064  536]
 [ 403  997]]
TSS: 0.6164285714285714
本轮评估完成 
Test set: Average loss: 7.1825, Accuracy: 6061/7000 (87%)

[[5064  536]
 [ 403  997]]
Recall [0.90428571 0.71214286]
Precision [0.92628498 0.65035877]
Accuracy [0.86585714 0.86585714]
TSS [0.61642857 0.61642857]
HSS [0.59522373 0.59522373]
FAR [0.07371502 0.34964123]
BS, BSS [0.13403060173180348, 0.16230873917622857]
数据集 5 测试集TSS: 0.6164285714285714
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='NN', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/6Train.csv每一类的数量是: [15640, 2160]
../../data/6Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/6Val.csv每一类的数量是: [6640, 880]
../../data/6Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/6Test.csv每一类的数量是: [5600, 1400]
../../data/6Test.csvget_Class函数得到的的权重： [0.625, 2.5]
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集6测试集轮评估数据=============================================
[[5045  555]
 [ 430  970]]
TSS: 0.59375
本轮评估完成 
Test set: Average loss: 6.8994, Accuracy: 6015/7000 (86%)

[[5045  555]
 [ 430  970]]
Recall [0.90089286 0.69285714]
Precision [0.92146119 0.63606557]
Accuracy [0.85928571 0.85928571]
TSS [0.59375 0.59375]
HSS [0.57451404 0.57451404]
FAR [0.07853881 0.36393443]
BS, BSS [0.12546026019487094, 0.21587337378205684]
数据集 6 测试集TSS: 0.59375
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='NN', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/7Train.csv每一类的数量是: [15640, 2160]
../../data/7Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/7Val.csv每一类的数量是: [6640, 880]
../../data/7Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/7Test.csv每一类的数量是: [5600, 1400]
../../data/7Test.csvget_Class函数得到的的权重： [0.625, 2.5]
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集7测试集轮评估数据=============================================
[[4973  627]
 [ 544  856]]
TSS: 0.4994642857142857
本轮评估完成 
Test set: Average loss: 7.3033, Accuracy: 5829/7000 (83%)

[[4973  627]
 [ 544  856]]
Recall [0.88803571 0.61142857]
Precision [0.90139569 0.57720836]
Accuracy [0.83271429 0.83271429]
TSS [0.49946429 0.49946429]
HSS [0.48860162 0.48860162]
FAR [0.09860431 0.42279164]
BS, BSS [0.1417648979406128, 0.11396938787117028]
数据集 7 测试集TSS: 0.4994642857142857
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='NN', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/8Train.csv每一类的数量是: [15640, 2160]
../../data/8Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/8Val.csv每一类的数量是: [6640, 880]
../../data/8Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/8Test.csv每一类的数量是: [5600, 1400]
../../data/8Test.csvget_Class函数得到的的权重： [0.625, 2.5]
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集8测试集轮评估数据=============================================
[[4971  629]
 [ 390 1010]]
TSS: 0.6091071428571428
本轮评估完成 
Test set: Average loss: 7.8460, Accuracy: 5981/7000 (85%)

[[4971  629]
 [ 390 1010]]
Recall [0.88767857 0.72142857]
Precision [0.92725238 0.61622941]
Accuracy [0.85442857 0.85442857]
TSS [0.60910714 0.60910714]
HSS [0.57245951 0.57245951]
FAR [0.07274762 0.38377059]
BS, BSS [0.1481931684055904, 0.07379269746506034]
数据集 8 测试集TSS: 0.6091071428571428
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='NN', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/9Train.csv每一类的数量是: [15640, 2160]
../../data/9Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/9Val.csv每一类的数量是: [6640, 880]
../../data/9Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/9Test.csv每一类的数量是: [5600, 1400]
../../data/9Test.csvget_Class函数得到的的权重： [0.625, 2.5]
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集9测试集轮评估数据=============================================
[[4760  840]
 [ 378 1022]]
TSS: 0.58
本轮评估完成 
Test set: Average loss: 7.2147, Accuracy: 5782/7000 (83%)

[[4760  840]
 [ 378 1022]]
Recall [0.85 0.73]
Precision [0.92643052 0.54887218]
Accuracy [0.826 0.826]
TSS [0.58 0.58]
HSS [0.51612903 0.51612903]
FAR [0.07356948 0.45112782]
BS, BSS [0.1362164391465542, 0.14864725533403655]
数据集 9 测试集TSS: 0.58
#接下来计算所有测试集指标均值和方法
[[49159  6841]
 [ 4071  9929]]
[[0.14452878206905506, 0.0966951120684062], [0.13546270829225188, 0.1533580731734261], [0.1462501588592004, 0.0859365071299979], [0.1413550472218122, 0.11653095486367415], [0.15794804833932416, 0.012824697879224356], [0.13403060173180348, 0.16230873917622857], [0.12546026019487094, 0.21587337378205684], [0.1417648979406128, 0.11396938787117028], [0.1481931684055904, 0.07379269746506034], [0.1362164391465542, 0.14864725533403655]]
结果已写入 ./model_output/2024-11-03-20-37-49/results.xlsx
程序运行时间: 0.06 分钟
