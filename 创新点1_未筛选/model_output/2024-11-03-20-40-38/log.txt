Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/0Train.csv每一类的数量是: [15640, 2160]
../../data/0Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/0Val.csv每一类的数量是: [6640, 880]
../../data/0Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/0Test.csv每一类的数量是: [5600, 1400]
../../data/0Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
train_x.shape : (445, 40, 10) 
train_y.shape : (445,) 
validate_x.shape : (188, 40, 10) 
validate_y.shape : (188,) 
test_x.shape : (175, 40, 10) 
test_y.shape : (175,) 
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集0测试集轮评估数据=============================================
[[122  18]
 [  9  26]]
TSS: 0.6142857142857143
本轮评估完成 
Test set: Average loss: 6.8721, Accuracy: 148/175 (85%)

[[122  18]
 [  9  26]]
Recall [0.87142857 0.74285714]
Precision [0.93129771 0.59090909]
Accuracy [0.84571429 0.84571429]
TSS [0.61428571 0.61428571]
HSS [0.56026059 0.56026059]
FAR [0.06870229 0.40909091]
data_FPR [0.25714286 0.12857143]
BS, BSS [0.13122778580744338, 0.17982633870347753]
数据集 0 测试集BSS: 0.17982633870347753
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/1Train.csv每一类的数量是: [15640, 2160]
../../data/1Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/1Val.csv每一类的数量是: [6640, 880]
../../data/1Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/1Test.csv每一类的数量是: [5600, 1400]
../../data/1Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集1测试集轮评估数据=============================================
[[136   4]
 [ 13  22]]
TSS: 0.6
本轮评估完成 
Test set: Average loss: 4.9050, Accuracy: 158/175 (90%)

[[136   4]
 [ 13  22]]
Recall [0.97142857 0.62857143]
Precision [0.91275168 0.84615385]
Accuracy [0.90285714 0.90285714]
TSS [0.6 0.6]
HSS [0.66403162 0.66403162]
FAR [0.08724832 0.15384615]
data_FPR [0.37142857 0.02857143]
BS, BSS [0.08860280416196802, 0.44623247398769894]
数据集 1 测试集BSS: 0.44623247398769894
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/2Train.csv每一类的数量是: [15640, 2160]
../../data/2Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/2Val.csv每一类的数量是: [6640, 880]
../../data/2Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/2Test.csv每一类的数量是: [5600, 1400]
../../data/2Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集2测试集轮评估数据=============================================
[[122  18]
 [  6  29]]
TSS: 0.7000000000000001
本轮评估完成 
Test set: Average loss: 7.0738, Accuracy: 151/175 (86%)

[[122  18]
 [  6  29]]
Recall [0.87142857 0.82857143]
Precision [0.953125   0.61702128]
Accuracy [0.86285714 0.86285714]
TSS [0.7 0.7]
HSS [0.62025316 0.62025316]
FAR [0.046875   0.38297872]
data_FPR [0.17142857 0.12857143]
BS, BSS [0.12851213820687352, 0.19679913620703915]
数据集 2 测试集BSS: 0.19679913620703915
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/3Train.csv每一类的数量是: [15640, 2160]
../../data/3Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/3Val.csv每一类的数量是: [6640, 880]
../../data/3Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/3Test.csv每一类的数量是: [5600, 1400]
../../data/3Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集3测试集轮评估数据=============================================
[[122  18]
 [  7  28]]
TSS: 0.6714285714285715
本轮评估完成 
Test set: Average loss: 7.3037, Accuracy: 150/175 (86%)

[[122  18]
 [  7  28]]
Recall [0.87142857 0.8       ]
Precision [0.94573643 0.60869565]
Accuracy [0.85714286 0.85714286]
TSS [0.67142857 0.67142857]
HSS [0.60063898 0.60063898]
FAR [0.05426357 0.39130435]
data_FPR [0.2        0.12857143]
BS, BSS [0.1382910118746661, 0.13568117578333538]
数据集 3 测试集BSS: 0.13568117578333538
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/4Train.csv每一类的数量是: [15640, 2160]
../../data/4Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/4Val.csv每一类的数量是: [6640, 880]
../../data/4Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/4Test.csv每一类的数量是: [5600, 1400]
../../data/4Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集4测试集轮评估数据=============================================
[[130  10]
 [ 16  19]]
TSS: 0.4714285714285714
本轮评估完成 
Test set: Average loss: 7.2030, Accuracy: 149/175 (85%)

[[130  10]
 [ 16  19]]
Recall [0.92857143 0.54285714]
Precision [0.89041096 0.65517241]
Accuracy [0.85142857 0.85142857]
TSS [0.47142857 0.47142857]
HSS [0.50381679 0.50381679]
FAR [0.10958904 0.34482759]
data_FPR [0.45714286 0.07142857]
BS, BSS [0.1364576926457975, 0.1471394209637642]
数据集 4 测试集BSS: 0.1471394209637642
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/5Train.csv每一类的数量是: [15640, 2160]
../../data/5Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/5Val.csv每一类的数量是: [6640, 880]
../../data/5Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/5Test.csv每一类的数量是: [5600, 1400]
../../data/5Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集5测试集轮评估数据=============================================
[[138   2]
 [ 17  18]]
TSS: 0.5
本轮评估完成 
Test set: Average loss: 4.8885, Accuracy: 156/175 (89%)

[[138   2]
 [ 17  18]]
Recall [0.98571429 0.51428571]
Precision [0.89032258 0.9       ]
Accuracy [0.89142857 0.89142857]
TSS [0.5 0.5]
HSS [0.59574468 0.59574468]
FAR [0.10967742 0.1       ]
data_FPR [0.48571429 0.01428571]
BS, BSS [0.08282626436310796, 0.48233584773057436]
数据集 5 测试集BSS: 0.48233584773057436
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/6Train.csv每一类的数量是: [15640, 2160]
../../data/6Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/6Val.csv每一类的数量是: [6640, 880]
../../data/6Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/6Test.csv每一类的数量是: [5600, 1400]
../../data/6Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集6测试集轮评估数据=============================================
[[131   9]
 [ 14  21]]
TSS: 0.5357142857142857
本轮评估完成 
Test set: Average loss: 6.3807, Accuracy: 152/175 (87%)

[[131   9]
 [ 14  21]]
Recall [0.93571429 0.6       ]
Precision [0.90344828 0.7       ]
Accuracy [0.86857143 0.86857143]
TSS [0.53571429 0.53571429]
HSS [0.56603774 0.56603774]
FAR [0.09655172 0.3       ]
data_FPR [0.4        0.06428571]
BS, BSS [0.1112005243595557, 0.3049967227527757]
数据集 6 测试集BSS: 0.3049967227527757
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/7Train.csv每一类的数量是: [15640, 2160]
../../data/7Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/7Val.csv每一类的数量是: [6640, 880]
../../data/7Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/7Test.csv每一类的数量是: [5600, 1400]
../../data/7Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集7测试集轮评估数据=============================================
[[118  22]
 [  5  30]]
TSS: 0.7
本轮评估完成 
Test set: Average loss: 6.9147, Accuracy: 148/175 (85%)

[[118  22]
 [  5  30]]
Recall [0.84285714 0.85714286]
Precision [0.95934959 0.57692308]
Accuracy [0.84571429 0.84571429]
TSS [0.7 0.7]
HSS [0.59214502 0.59214502]
FAR [0.04065041 0.42307692]
data_FPR [0.14285714 0.15714286]
BS, BSS [0.13046319005544893, 0.18460506215344274]
数据集 7 测试集BSS: 0.18460506215344274
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/8Train.csv每一类的数量是: [15640, 2160]
../../data/8Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/8Val.csv每一类的数量是: [6640, 880]
../../data/8Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/8Test.csv每一类的数量是: [5600, 1400]
../../data/8Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集8测试集轮评估数据=============================================
[[126  14]
 [ 12  23]]
TSS: 0.5571428571428572
本轮评估完成 
Test set: Average loss: 7.1400, Accuracy: 149/175 (85%)

[[126  14]
 [ 12  23]]
Recall [0.9        0.65714286]
Precision [0.91304348 0.62162162]
Accuracy [0.85142857 0.85142857]
TSS [0.55714286 0.55714286]
HSS [0.54545455 0.54545455]
FAR [0.08695652 0.37837838]
data_FPR [0.34285714 0.1       ]
BS, BSS [0.12342957622986389, 0.2285651485633493]
数据集 8 测试集BSS: 0.2285651485633493
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/9Train.csv每一类的数量是: [15640, 2160]
../../data/9Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/9Val.csv每一类的数量是: [6640, 880]
../../data/9Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/9Test.csv每一类的数量是: [5600, 1400]
../../data/9Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集9测试集轮评估数据=============================================
[[116  24]
 [  4  31]]
TSS: 0.7142857142857143
本轮评估完成 
Test set: Average loss: 7.6007, Accuracy: 147/175 (84%)

[[116  24]
 [  4  31]]
Recall [0.82857143 0.88571429]
Precision [0.96666667 0.56363636]
Accuracy [0.84 0.84]
TSS [0.71428571 0.71428571]
HSS [0.58823529 0.58823529]
FAR [0.03333333 0.43636364]
data_FPR [0.11428571 0.17142857]
BS, BSS [0.13319305769907516, 0.16754338938077884]
数据集 9 测试集BSS: 0.16754338938077884
#接下来计算所有测试集指标均值和方法
[[1261  139]
 [ 103  247]]
[[0.13122778580744338, 0.17982633870347753], [0.08860280416196802, 0.44623247398769894], [0.12851213820687352, 0.19679913620703915], [0.1382910118746661, 0.13568117578333538], [0.1364576926457975, 0.1471394209637642], [0.08282626436310796, 0.48233584773057436], [0.1112005243595557, 0.3049967227527757], [0.13046319005544893, 0.18460506215344274], [0.12342957622986389, 0.2285651485633493], [0.13319305769907516, 0.16754338938077884]]
结果已写入 ./model_output/2024-11-03-20-40-38/results.xlsx
程序运行时间: 0.15 分钟
lr0.001_epochs160_datasetNum9_modelTypeVIT_batchsize16_numhiddenlayers4_lr0.001_numheads5_embeddim100_hiddenunits256_numlayers2_datasetnamedata
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/0Train.csv每一类的数量是: [15640, 2160]
../../data/0Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/0Val.csv每一类的数量是: [6640, 880]
../../data/0Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/0Test.csv每一类的数量是: [5600, 1400]
../../data/0Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集0测试集轮评估数据=============================================
[[124  16]
 [  9  26]]
TSS: 0.6285714285714286
本轮评估完成 
Test set: Average loss: 6.6642, Accuracy: 150/175 (86%)

[[124  16]
 [  9  26]]
Recall [0.88571429 0.74285714]
Precision [0.93233083 0.61904762]
Accuracy [0.85714286 0.85714286]
TSS [0.62857143 0.62857143]
HSS [0.58471761 0.58471761]
FAR [0.06766917 0.38095238]
data_FPR [0.25714286 0.11428571]
BS, BSS [0.1266761853451608, 0.20827384159274354]
数据集 0 测试集BSS: 0.20827384159274354
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/1Train.csv每一类的数量是: [15640, 2160]
../../data/1Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/1Val.csv每一类的数量是: [6640, 880]
../../data/1Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/1Test.csv每一类的数量是: [5600, 1400]
../../data/1Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集1测试集轮评估数据=============================================
[[125  15]
 [  4  31]]
TSS: 0.7785714285714286
本轮评估完成 
Test set: Average loss: 6.1275, Accuracy: 156/175 (89%)

[[125  15]
 [  4  31]]
Recall [0.89285714 0.88571429]
Precision [0.96899225 0.67391304]
Accuracy [0.89142857 0.89142857]
TSS [0.77857143 0.77857143]
HSS [0.69648562 0.69648562]
FAR [0.03100775 0.32608696]
data_FPR [0.11428571 0.10714286]
BS, BSS [0.11325487648134311, 0.2921570219916043]
数据集 1 测试集BSS: 0.2921570219916043
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/2Train.csv每一类的数量是: [15640, 2160]
../../data/2Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/2Val.csv每一类的数量是: [6640, 880]
../../data/2Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/2Test.csv每一类的数量是: [5600, 1400]
../../data/2Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集2测试集轮评估数据=============================================
[[124  16]
 [  6  29]]
TSS: 0.7142857142857143
本轮评估完成 
Test set: Average loss: 7.1944, Accuracy: 153/175 (87%)

[[124  16]
 [  6  29]]
Recall [0.88571429 0.82857143]
Precision [0.95384615 0.64444444]
Accuracy [0.87428571 0.87428571]
TSS [0.71428571 0.71428571]
HSS [0.64516129 0.64516129]
FAR [0.04615385 0.35555556]
data_FPR [0.17142857 0.11428571]
BS, BSS [0.1309235109075654, 0.18172805682771487]
数据集 2 测试集BSS: 0.18172805682771487
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/3Train.csv每一类的数量是: [15640, 2160]
../../data/3Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/3Val.csv每一类的数量是: [6640, 880]
../../data/3Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/3Test.csv每一类的数量是: [5600, 1400]
../../data/3Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集3测试集轮评估数据=============================================
[[113  27]
 [  5  30]]
TSS: 0.6642857142857143
本轮评估完成 
Test set: Average loss: 7.3198, Accuracy: 143/175 (82%)

[[113  27]
 [  5  30]]
Recall [0.80714286 0.85714286]
Precision [0.95762712 0.52631579]
Accuracy [0.81714286 0.81714286]
TSS [0.66428571 0.66428571]
HSS [0.53757225 0.53757225]
FAR [0.04237288 0.47368421]
data_FPR [0.14285714 0.19285714]
BS, BSS [0.1407078648776553, 0.12057584451465286]
数据集 3 测试集BSS: 0.12057584451465286
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/4Train.csv每一类的数量是: [15640, 2160]
../../data/4Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/4Val.csv每一类的数量是: [6640, 880]
../../data/4Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/4Test.csv每一类的数量是: [5600, 1400]
../../data/4Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集4测试集轮评估数据=============================================
[[125  15]
 [  4  31]]
TSS: 0.7785714285714286
本轮评估完成 
Test set: Average loss: 7.4008, Accuracy: 156/175 (89%)

[[125  15]
 [  4  31]]
Recall [0.89285714 0.88571429]
Precision [0.96899225 0.67391304]
Accuracy [0.89142857 0.89142857]
TSS [0.77857143 0.77857143]
HSS [0.69648562 0.69648562]
FAR [0.03100775 0.32608696]
data_FPR [0.11428571 0.10714286]
BS, BSS [0.11831626033595287, 0.26052337290029326]
数据集 4 测试集BSS: 0.26052337290029326
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/5Train.csv每一类的数量是: [15640, 2160]
../../data/5Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/5Val.csv每一类的数量是: [6640, 880]
../../data/5Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/5Test.csv每一类的数量是: [5600, 1400]
../../data/5Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集5测试集轮评估数据=============================================
[[133   7]
 [ 13  22]]
TSS: 0.5785714285714285
本轮评估完成 
Test set: Average loss: 6.1463, Accuracy: 155/175 (89%)

[[133   7]
 [ 13  22]]
Recall [0.95       0.62857143]
Precision [0.9109589  0.75862069]
Accuracy [0.88571429 0.88571429]
TSS [0.57857143 0.57857143]
HSS [0.61832061 0.61832061]
FAR [0.0890411  0.24137931]
data_FPR [0.37142857 0.05      ]
BS, BSS [0.11080472634273765, 0.3074704603578885]
数据集 5 测试集BSS: 0.3074704603578885
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/6Train.csv每一类的数量是: [15640, 2160]
../../data/6Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/6Val.csv每一类的数量是: [6640, 880]
../../data/6Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/6Test.csv每一类的数量是: [5600, 1400]
../../data/6Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集6测试集轮评估数据=============================================
[[130  10]
 [  9  26]]
TSS: 0.6714285714285715
本轮评估完成 
Test set: Average loss: 6.0537, Accuracy: 156/175 (89%)

[[130  10]
 [  9  26]]
Recall [0.92857143 0.74285714]
Precision [0.9352518  0.72222222]
Accuracy [0.89142857 0.89142857]
TSS [0.67142857 0.67142857]
HSS [0.66431095 0.66431095]
FAR [0.0647482  0.27777778]
data_FPR [0.25714286 0.07142857]
BS, BSS [0.1044158037466067, 0.3474012265837071]
数据集 6 测试集BSS: 0.3474012265837071
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/7Train.csv每一类的数量是: [15640, 2160]
../../data/7Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/7Val.csv每一类的数量是: [6640, 880]
../../data/7Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/7Test.csv每一类的数量是: [5600, 1400]
../../data/7Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集7测试集轮评估数据=============================================
[[120  20]
 [  5  30]]
TSS: 0.7142857142857142
本轮评估完成 
Test set: Average loss: 6.3998, Accuracy: 150/175 (86%)

[[120  20]
 [  5  30]]
Recall [0.85714286 0.85714286]
Precision [0.96 0.6 ]
Accuracy [0.85714286 0.85714286]
TSS [0.71428571 0.71428571]
HSS [0.61538462 0.61538462]
FAR [0.04 0.4 ]
data_FPR [0.14285714 0.14285714]
BS, BSS [0.12100099709992258, 0.2437437681254826]
数据集 7 测试集BSS: 0.2437437681254826
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/8Train.csv每一类的数量是: [15640, 2160]
../../data/8Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/8Val.csv每一类的数量是: [6640, 880]
../../data/8Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/8Test.csv每一类的数量是: [5600, 1400]
../../data/8Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集8测试集轮评估数据=============================================
[[123  17]
 [  9  26]]
TSS: 0.6214285714285714
本轮评估完成 
Test set: Average loss: 7.0274, Accuracy: 149/175 (85%)

[[123  17]
 [  9  26]]
Recall [0.87857143 0.74285714]
Precision [0.93181818 0.60465116]
Accuracy [0.85142857 0.85142857]
TSS [0.62142857 0.62142857]
HSS [0.57236842 0.57236842]
FAR [0.06818182 0.39534884]
data_FPR [0.25714286 0.12142857]
BS, BSS [0.12028283369208928, 0.24823228942444076]
数据集 8 测试集BSS: 0.24823228942444076
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/9Train.csv每一类的数量是: [15640, 2160]
../../data/9Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/9Val.csv每一类的数量是: [6640, 880]
../../data/9Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/9Test.csv每一类的数量是: [5600, 1400]
../../data/9Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集9测试集轮评估数据=============================================
[[115  25]
 [  4  31]]
TSS: 0.7071428571428571
本轮评估完成 
Test set: Average loss: 7.5961, Accuracy: 146/175 (83%)

[[115  25]
 [  4  31]]
Recall [0.82142857 0.88571429]
Precision [0.96638655 0.55357143]
Accuracy [0.83428571 0.83428571]
TSS [0.70714286 0.70714286]
HSS [0.57725948 0.57725948]
FAR [0.03361345 0.44642857]
data_FPR [0.11428571 0.17857143]
BS, BSS [0.1281403135923557, 0.19912304004777548]
数据集 9 测试集BSS: 0.19912304004777548
#接下来计算所有测试集指标均值和方法
[[1232  168]
 [  68  282]]
[[0.1266761853451608, 0.20827384159274354], [0.11325487648134311, 0.2921570219916043], [0.1309235109075654, 0.18172805682771487], [0.1407078648776553, 0.12057584451465286], [0.11831626033595287, 0.26052337290029326], [0.11080472634273765, 0.3074704603578885], [0.1044158037466067, 0.3474012265837071], [0.12100099709992258, 0.2437437681254826], [0.12028283369208928, 0.24823228942444076], [0.1281403135923557, 0.19912304004777548]]
结果已写入 ./model_output/2024-11-03-20-40-47/results.xlsx
程序运行时间: 0.11 分钟
lr0.001_epochs160_datasetNum9_modelTypeLLM_batchsize16_numhiddenlayers4_lr0.001_numheads5_embeddim100_hiddenunits256_numlayers2_datasetnamedata
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/0Train.csv每一类的数量是: [15640, 2160]
../../data/0Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/0Val.csv每一类的数量是: [6640, 880]
../../data/0Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/0Test.csv每一类的数量是: [5600, 1400]
../../data/0Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集0测试集轮评估数据=============================================
[[140   0]
 [ 35   0]]
TSS: 0.0
本轮评估完成 
Test set: Average loss: 8.7966, Accuracy: 140/175 (80%)

[[140   0]
 [ 35   0]]
Recall [1. 0.]
Precision [0.8 0. ]
Accuracy [0.8 0.8]
TSS [0. 0.]
HSS [0. 0.]
FAR [0.2 0. ]
data_FPR [1. 0.]
BS, BSS [0.1817460822710013, -0.13591301419376012]
数据集 0 测试集BSS: -0.13591301419376012
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/1Train.csv每一类的数量是: [15640, 2160]
../../data/1Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/1Val.csv每一类的数量是: [6640, 880]
../../data/1Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/1Test.csv每一类的数量是: [5600, 1400]
../../data/1Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集1测试集轮评估数据=============================================
[[120  20]
 [  8  27]]
TSS: 0.6285714285714286
本轮评估完成 
Test set: Average loss: 7.5946, Accuracy: 147/175 (84%)

[[120  20]
 [  8  27]]
Recall [0.85714286 0.77142857]
Precision [0.9375     0.57446809]
Accuracy [0.84 0.84]
TSS [0.62857143 0.62857143]
HSS [0.55696203 0.55696203]
FAR [0.0625     0.42553191]
data_FPR [0.22857143 0.14285714]
BS, BSS [0.14770726170374315, 0.07682961435160374]
数据集 1 测试集BSS: 0.07682961435160374
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/2Train.csv每一类的数量是: [15640, 2160]
../../data/2Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/2Val.csv每一类的数量是: [6640, 880]
../../data/2Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/2Test.csv每一类的数量是: [5600, 1400]
../../data/2Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集2测试集轮评估数据=============================================
[[127  13]
 [ 13  22]]
TSS: 0.5357142857142857
本轮评估完成 
Test set: Average loss: 8.1711, Accuracy: 149/175 (85%)

[[127  13]
 [ 13  22]]
Recall [0.90714286 0.62857143]
Precision [0.90714286 0.62857143]
Accuracy [0.85142857 0.85142857]
TSS [0.53571429 0.53571429]
HSS [0.53571429 0.53571429]
FAR [0.09285714 0.37142857]
data_FPR [0.37142857 0.09285714]
BS, BSS [0.1625037918308639, -0.015648698942900996]
数据集 2 测试集BSS: -0.015648698942900996
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/3Train.csv每一类的数量是: [15640, 2160]
../../data/3Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/3Val.csv每一类的数量是: [6640, 880]
../../data/3Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/3Test.csv每一类的数量是: [5600, 1400]
../../data/3Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集3测试集轮评估数据=============================================
[[117  23]
 [ 10  25]]
TSS: 0.55
本轮评估完成 
Test set: Average loss: 10.0306, Accuracy: 142/175 (81%)

[[117  23]
 [ 10  25]]
Recall [0.83571429 0.71428571]
Precision [0.92125984 0.52083333]
Accuracy [0.81142857 0.81142857]
TSS [0.55 0.55]
HSS [0.48275862 0.48275862]
FAR [0.07874016 0.47916667]
data_FPR [0.28571429 0.16428571]
BS, BSS [0.21205086981125118, -0.32531793632032224]
数据集 3 测试集BSS: -0.32531793632032224
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/4Train.csv每一类的数量是: [15640, 2160]
../../data/4Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/4Val.csv每一类的数量是: [6640, 880]
../../data/4Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/4Test.csv每一类的数量是: [5600, 1400]
../../data/4Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集4测试集轮评估数据=============================================
[[101  39]
 [  6  29]]
TSS: 0.55
本轮评估完成 
Test set: Average loss: 9.0909, Accuracy: 130/175 (74%)

[[101  39]
 [  6  29]]
Recall [0.72142857 0.82857143]
Precision [0.94392523 0.42647059]
Accuracy [0.74285714 0.74285714]
TSS [0.55 0.55]
HSS [0.40633245 0.40633245]
FAR [0.05607477 0.57352941]
data_FPR [0.17142857 0.27857143]
BS, BSS [0.19315753504465313, -0.20723459402908406]
数据集 4 测试集BSS: -0.20723459402908406
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/5Train.csv每一类的数量是: [15640, 2160]
../../data/5Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/5Val.csv每一类的数量是: [6640, 880]
../../data/5Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/5Test.csv每一类的数量是: [5600, 1400]
../../data/5Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集5测试集轮评估数据=============================================
[[132   8]
 [ 23  12]]
TSS: 0.2857142857142857
本轮评估完成 
Test set: Average loss: 8.4158, Accuracy: 144/175 (82%)

[[132   8]
 [ 23  12]]
Recall [0.94285714 0.34285714]
Precision [0.8516129 0.6      ]
Accuracy [0.82285714 0.82285714]
TSS [0.28571429 0.28571429]
HSS [0.34042553 0.34042553]
FAR [0.1483871 0.4      ]
data_FPR [0.65714286 0.05714286]
BS, BSS [0.1567059863518967, 0.020587585300643974]
数据集 5 测试集BSS: 0.020587585300643974
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/6Train.csv每一类的数量是: [15640, 2160]
../../data/6Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/6Val.csv每一类的数量是: [6640, 880]
../../data/6Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/6Test.csv每一类的数量是: [5600, 1400]
../../data/6Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集6测试集轮评估数据=============================================
[[140   0]
 [ 35   0]]
TSS: 0.0
本轮评估完成 
Test set: Average loss: 7.9809, Accuracy: 140/175 (80%)

[[140   0]
 [ 35   0]]
Recall [1. 0.]
Precision [0.8 0. ]
Accuracy [0.8 0.8]
TSS [0. 0.]
HSS [0. 0.]
FAR [0.2 0. ]
data_FPR [1. 0.]
BS, BSS [0.16042153604463613, -0.002634600278977439]
数据集 6 测试集BSS: -0.002634600278977439
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/7Train.csv每一类的数量是: [15640, 2160]
../../data/7Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/7Val.csv每一类的数量是: [6640, 880]
../../data/7Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/7Test.csv每一类的数量是: [5600, 1400]
../../data/7Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集7测试集轮评估数据=============================================
[[117  23]
 [ 15  20]]
TSS: 0.40714285714285714
本轮评估完成 
Test set: Average loss: 9.2973, Accuracy: 137/175 (78%)

[[117  23]
 [ 15  20]]
Recall [0.83571429 0.57142857]
Precision [0.88636364 0.46511628]
Accuracy [0.78285714 0.78285714]
TSS [0.40714286 0.40714286]
HSS [0.375 0.375]
FAR [0.11363636 0.53488372]
data_FPR [0.42857143 0.16428571]
BS, BSS [0.19601292331573714, -0.2250807707233593]
数据集 7 测试集BSS: -0.2250807707233593
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/8Train.csv每一类的数量是: [15640, 2160]
../../data/8Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/8Val.csv每一类的数量是: [6640, 880]
../../data/8Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/8Test.csv每一类的数量是: [5600, 1400]
../../data/8Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集8测试集轮评估数据=============================================
[[134   6]
 [ 33   2]]
TSS: 0.014285714285714346
本轮评估完成 
Test set: Average loss: 7.5183, Accuracy: 136/175 (78%)

[[134   6]
 [ 33   2]]
Recall [0.95714286 0.05714286]
Precision [0.80239521 0.25      ]
Accuracy [0.77714286 0.77714286]
TSS [0.01428571 0.01428571]
HSS [0.0201005 0.0201005]
FAR [0.19760479 0.75      ]
data_FPR [0.94285714 0.04285714]
BS, BSS [0.15431704001258, 0.03551849992137324]
数据集 8 测试集BSS: 0.03551849992137324
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/9Train.csv每一类的数量是: [15640, 2160]
../../data/9Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/9Val.csv每一类的数量是: [6640, 880]
../../data/9Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/9Test.csv每一类的数量是: [5600, 1400]
../../data/9Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集9测试集轮评估数据=============================================
[[130  10]
 [ 12  23]]
TSS: 0.5857142857142857
本轮评估完成 
Test set: Average loss: 4.9557, Accuracy: 153/175 (87%)

[[130  10]
 [ 12  23]]
Recall [0.92857143 0.65714286]
Precision [0.91549296 0.6969697 ]
Accuracy [0.87428571 0.87428571]
TSS [0.58571429 0.58571429]
HSS [0.59854015 0.59854015]
FAR [0.08450704 0.3030303 ]
data_FPR [0.34285714 0.07142857]
BS, BSS [0.09575770588269823, 0.401514338233135]
数据集 9 测试集BSS: 0.401514338233135
#接下来计算所有测试集指标均值和方法
[[1258  142]
 [ 190  160]]
[[0.1817460822710013, -0.13591301419376012], [0.14770726170374315, 0.07682961435160374], [0.1625037918308639, -0.015648698942900996], [0.21205086981125118, -0.32531793632032224], [0.19315753504465313, -0.20723459402908406], [0.1567059863518967, 0.020587585300643974], [0.16042153604463613, -0.002634600278977439], [0.19601292331573714, -0.2250807707233593], [0.15431704001258, 0.03551849992137324], [0.09575770588269823, 0.401514338233135]]
结果已写入 ./model_output/2024-11-03-20-40-54/results.xlsx
程序运行时间: 0.13 分钟
lr0.001_epochs160_datasetNum9_modelTypeLSTM_batchsize16_numhiddenlayers4_lr0.001_numheads5_embeddim100_hiddenunits256_numlayers2_datasetnamedata
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/0Train.csv每一类的数量是: [15640, 2160]
../../data/0Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/0Val.csv每一类的数量是: [6640, 880]
../../data/0Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/0Test.csv每一类的数量是: [5600, 1400]
../../data/0Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集0测试集轮评估数据=============================================
[[119  21]
 [  6  29]]
TSS: 0.6785714285714286
本轮评估完成 
Test set: Average loss: 7.4503, Accuracy: 148/175 (85%)

[[119  21]
 [  6  29]]
Recall [0.85       0.82857143]
Precision [0.952 0.58 ]
Accuracy [0.84571429 0.84571429]
TSS [0.67857143 0.67857143]
HSS [0.58461538 0.58461538]
FAR [0.048 0.42 ]
data_FPR [0.17142857 0.15      ]
BS, BSS [0.14023716646169618, 0.12351770961439734]
数据集 0 测试集BSS: 0.12351770961439734
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/1Train.csv每一类的数量是: [15640, 2160]
../../data/1Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/1Val.csv每一类的数量是: [6640, 880]
../../data/1Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/1Test.csv每一类的数量是: [5600, 1400]
../../data/1Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集1测试集轮评估数据=============================================
[[123  17]
 [  3  32]]
TSS: 0.7928571428571428
本轮评估完成 
Test set: Average loss: 7.4605, Accuracy: 155/175 (89%)

[[123  17]
 [  3  32]]
Recall [0.87857143 0.91428571]
Precision [0.97619048 0.65306122]
Accuracy [0.88571429 0.88571429]
TSS [0.79285714 0.79285714]
HSS [0.68944099 0.68944099]
FAR [0.02380952 0.34693878]
data_FPR [0.08571429 0.12142857]
BS, BSS [0.14073438434875343, 0.12041009782028955]
数据集 1 测试集BSS: 0.12041009782028955
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/2Train.csv每一类的数量是: [15640, 2160]
../../data/2Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/2Val.csv每一类的数量是: [6640, 880]
../../data/2Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/2Test.csv每一类的数量是: [5600, 1400]
../../data/2Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集2测试集轮评估数据=============================================
[[116  24]
 [  2  33]]
TSS: 0.7714285714285715
本轮评估完成 
Test set: Average loss: 7.5173, Accuracy: 149/175 (85%)

[[116  24]
 [  2  33]]
Recall [0.82857143 0.94285714]
Precision [0.98305085 0.57894737]
Accuracy [0.85142857 0.85142857]
TSS [0.77142857 0.77142857]
HSS [0.62427746 0.62427746]
FAR [0.01694915 0.42105263]
data_FPR [0.05714286 0.17142857]
BS, BSS [0.139528440155615, 0.12794724902740473]
数据集 2 测试集BSS: 0.12794724902740473
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/3Train.csv每一类的数量是: [15640, 2160]
../../data/3Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/3Val.csv每一类的数量是: [6640, 880]
../../data/3Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/3Test.csv每一类的数量是: [5600, 1400]
../../data/3Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集3测试集轮评估数据=============================================
[[105  35]
 [  5  30]]
TSS: 0.6071428571428571
本轮评估完成 
Test set: Average loss: 7.7152, Accuracy: 135/175 (77%)

[[105  35]
 [  5  30]]
Recall [0.75       0.85714286]
Precision [0.95454545 0.46153846]
Accuracy [0.77142857 0.77142857]
TSS [0.60714286 0.60714286]
HSS [0.45945946 0.45945946]
FAR [0.04545455 0.53846154]
data_FPR [0.14285714 0.25      ]
BS, BSS [0.15475982895190862, 0.03275106905056946]
数据集 3 测试集BSS: 0.03275106905056946
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/4Train.csv每一类的数量是: [15640, 2160]
../../data/4Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/4Val.csv每一类的数量是: [6640, 880]
../../data/4Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/4Test.csv每一类的数量是: [5600, 1400]
../../data/4Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集4测试集轮评估数据=============================================
[[118  22]
 [  3  32]]
TSS: 0.7571428571428571
本轮评估完成 
Test set: Average loss: 6.9444, Accuracy: 150/175 (86%)

[[118  22]
 [  3  32]]
Recall [0.84285714 0.91428571]
Precision [0.97520661 0.59259259]
Accuracy [0.85714286 0.85714286]
TSS [0.75714286 0.75714286]
HSS [0.62908012 0.62908012]
FAR [0.02479339 0.40740741]
data_FPR [0.08571429 0.15714286]
BS, BSS [0.1263847747558113, 0.21009515777617793]
数据集 4 测试集BSS: 0.21009515777617793
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/5Train.csv每一类的数量是: [15640, 2160]
../../data/5Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/5Val.csv每一类的数量是: [6640, 880]
../../data/5Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/5Test.csv每一类的数量是: [5600, 1400]
../../data/5Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集5测试集轮评估数据=============================================
[[125  15]
 [  6  29]]
TSS: 0.7214285714285715
本轮评估完成 
Test set: Average loss: 6.5283, Accuracy: 154/175 (88%)

[[125  15]
 [  6  29]]
Recall [0.89285714 0.82857143]
Precision [0.95419847 0.65909091]
Accuracy [0.88 0.88]
TSS [0.72142857 0.72142857]
HSS [0.65798046 0.65798046]
FAR [0.04580153 0.34090909]
data_FPR [0.17142857 0.10714286]
BS, BSS [0.12060726899428827, 0.24620456878569708]
数据集 5 测试集BSS: 0.24620456878569708
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/6Train.csv每一类的数量是: [15640, 2160]
../../data/6Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/6Val.csv每一类的数量是: [6640, 880]
../../data/6Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/6Test.csv每一类的数量是: [5600, 1400]
../../data/6Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集6测试集轮评估数据=============================================
[[124  16]
 [  8  27]]
TSS: 0.6571428571428571
本轮评估完成 
Test set: Average loss: 6.0401, Accuracy: 151/175 (86%)

[[124  16]
 [  8  27]]
Recall [0.88571429 0.77142857]
Precision [0.93939394 0.62790698]
Accuracy [0.86285714 0.86285714]
TSS [0.65714286 0.65714286]
HSS [0.60526316 0.60526316]
FAR [0.06060606 0.37209302]
data_FPR [0.22857143 0.11428571]
BS, BSS [0.10964485729780324, 0.3147196418887286]
数据集 6 测试集BSS: 0.3147196418887286
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/7Train.csv每一类的数量是: [15640, 2160]
../../data/7Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/7Val.csv每一类的数量是: [6640, 880]
../../data/7Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/7Test.csv每一类的数量是: [5600, 1400]
../../data/7Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集7测试集轮评估数据=============================================
[[122  18]
 [  6  29]]
TSS: 0.7000000000000001
本轮评估完成 
Test set: Average loss: 7.5910, Accuracy: 151/175 (86%)

[[122  18]
 [  6  29]]
Recall [0.87142857 0.82857143]
Precision [0.953125   0.61702128]
Accuracy [0.86285714 0.86285714]
TSS [0.7 0.7]
HSS [0.62025316 0.62025316]
FAR [0.046875   0.38297872]
data_FPR [0.17142857 0.12857143]
BS, BSS [0.1408651296453477, 0.11959293971657536]
数据集 7 测试集BSS: 0.11959293971657536
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/8Train.csv每一类的数量是: [15640, 2160]
../../data/8Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/8Val.csv每一类的数量是: [6640, 880]
../../data/8Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/8Test.csv每一类的数量是: [5600, 1400]
../../data/8Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集8测试集轮评估数据=============================================
[[118  22]
 [  5  30]]
TSS: 0.7
本轮评估完成 
Test set: Average loss: 7.2740, Accuracy: 148/175 (85%)

[[118  22]
 [  5  30]]
Recall [0.84285714 0.85714286]
Precision [0.95934959 0.57692308]
Accuracy [0.84571429 0.84571429]
TSS [0.7 0.7]
HSS [0.59214502 0.59214502]
FAR [0.04065041 0.42307692]
data_FPR [0.14285714 0.15714286]
BS, BSS [0.1337276957035809, 0.16420190185261796]
数据集 8 测试集BSS: 0.16420190185261796
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/9Train.csv每一类的数量是: [15640, 2160]
../../data/9Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/9Val.csv每一类的数量是: [6640, 880]
../../data/9Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/9Test.csv每一类的数量是: [5600, 1400]
../../data/9Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集9测试集轮评估数据=============================================
[[112  28]
 [  3  32]]
TSS: 0.7142857142857143
本轮评估完成 
Test set: Average loss: 7.9992, Accuracy: 144/175 (82%)

[[112  28]
 [  3  32]]
Recall [0.8        0.91428571]
Precision [0.97391304 0.53333333]
Accuracy [0.82285714 0.82285714]
TSS [0.71428571 0.71428571]
HSS [0.56338028 0.56338028]
FAR [0.02608696 0.46666667]
data_FPR [0.08571429 0.2       ]
BS, BSS [0.1522729871292724, 0.04829383044204594]
数据集 9 测试集BSS: 0.04829383044204594
#接下来计算所有测试集指标均值和方法
[[1182  218]
 [  47  303]]
[[0.14023716646169618, 0.12351770961439734], [0.14073438434875343, 0.12041009782028955], [0.139528440155615, 0.12794724902740473], [0.15475982895190862, 0.03275106905056946], [0.1263847747558113, 0.21009515777617793], [0.12060726899428827, 0.24620456878569708], [0.10964485729780324, 0.3147196418887286], [0.1408651296453477, 0.11959293971657536], [0.1337276957035809, 0.16420190185261796], [0.1522729871292724, 0.04829383044204594]]
结果已写入 ./model_output/2024-11-03-20-41-02/results.xlsx
程序运行时间: 0.12 分钟
