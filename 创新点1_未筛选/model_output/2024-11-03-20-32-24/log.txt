Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/0Train.csv每一类的数量是: [15640, 2160]
../../data/0Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/0Val.csv每一类的数量是: [6640, 880]
../../data/0Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/0Test.csv每一类的数量是: [5600, 1400]
../../data/0Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
train_x.shape : (445, 40, 10) 
train_y.shape : (445,) 
validate_x.shape : (188, 40, 10) 
validate_y.shape : (188,) 
test_x.shape : (175, 40, 10) 
test_y.shape : (175,) 
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集0测试集轮评估数据=============================================
[[113  27]
 [  4  31]]
TSS: 0.6928571428571428
本轮评估完成 
Test set: Average loss: 7.8111, Accuracy: 144/175 (82%)

[[113  27]
 [  4  31]]
data_FPR [0.11428571 0.19285714]
Recall [0.80714286 0.88571429]
Precision [0.96581197 0.53448276]
Accuracy [0.82285714 0.82285714]
TSS [0.69285714 0.69285714]
HSS [0.55587393 0.55587393]
FAR [0.03418803 0.46551724]
BS, BSS [0.1553524887714022, 0.029046945178736405]
数据集 0 测试集TSS: 0.6928571428571428
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/1Train.csv每一类的数量是: [15640, 2160]
../../data/1Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/1Val.csv每一类的数量是: [6640, 880]
../../data/1Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/1Test.csv每一类的数量是: [5600, 1400]
../../data/1Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集1测试集轮评估数据=============================================
[[125  15]
 [  3  32]]
TSS: 0.8071428571428572
本轮评估完成 
Test set: Average loss: 6.4608, Accuracy: 157/175 (90%)

[[125  15]
 [  3  32]]
data_FPR [0.08571429 0.10714286]
Recall [0.89285714 0.91428571]
Precision [0.9765625  0.68085106]
Accuracy [0.89714286 0.89714286]
TSS [0.80714286 0.80714286]
HSS [0.71518987 0.71518987]
FAR [0.0234375  0.31914894]
BS, BSS [0.11987183449196723, 0.25080103442520496]
数据集 1 测试集TSS: 0.8071428571428572
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/2Train.csv每一类的数量是: [15640, 2160]
../../data/2Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/2Val.csv每一类的数量是: [6640, 880]
../../data/2Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/2Test.csv每一类的数量是: [5600, 1400]
../../data/2Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集2测试集轮评估数据=============================================
[[107  33]
 [  0  35]]
TSS: 0.7642857142857142
本轮评估完成 
Test set: Average loss: 10.1759, Accuracy: 142/175 (81%)

[[107  33]
 [  0  35]]
data_FPR [0.         0.23571429]
Recall [0.76428571 1.        ]
Precision [1.         0.51470588]
Accuracy [0.81142857 0.81142857]
TSS [0.76428571 0.76428571]
HSS [0.5646438 0.5646438]
FAR [0.         0.48529412]
BS, BSS [0.17435404674502042, -0.0897127921563774]
数据集 2 测试集TSS: 0.7642857142857142
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/3Train.csv每一类的数量是: [15640, 2160]
../../data/3Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/3Val.csv每一类的数量是: [6640, 880]
../../data/3Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/3Test.csv每一类的数量是: [5600, 1400]
../../data/3Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集3测试集轮评估数据=============================================
[[122  18]
 [  6  29]]
TSS: 0.7000000000000001
本轮评估完成 
Test set: Average loss: 7.4640, Accuracy: 151/175 (86%)

[[122  18]
 [  6  29]]
data_FPR [0.17142857 0.12857143]
Recall [0.87142857 0.82857143]
Precision [0.953125   0.61702128]
Accuracy [0.86285714 0.86285714]
TSS [0.7 0.7]
HSS [0.62025316 0.62025316]
FAR [0.046875   0.38297872]
BS, BSS [0.1426890514399917, 0.10819342850005209]
数据集 3 测试集TSS: 0.7000000000000001
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/4Train.csv每一类的数量是: [15640, 2160]
../../data/4Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/4Val.csv每一类的数量是: [6640, 880]
../../data/4Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/4Test.csv每一类的数量是: [5600, 1400]
../../data/4Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集4测试集轮评估数据=============================================
[[112  28]
 [  2  33]]
TSS: 0.7428571428571429
本轮评估完成 
Test set: Average loss: 9.5671, Accuracy: 145/175 (83%)

[[112  28]
 [  2  33]]
data_FPR [0.05714286 0.2       ]
Recall [0.8        0.94285714]
Precision [0.98245614 0.54098361]
Accuracy [0.82857143 0.82857143]
TSS [0.74285714 0.74285714]
HSS [0.58100559 0.58100559]
FAR [0.01754386 0.45901639]
BS, BSS [0.1649460852451276, -0.030913032782047267]
数据集 4 测试集TSS: 0.7428571428571429
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/5Train.csv每一类的数量是: [15640, 2160]
../../data/5Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/5Val.csv每一类的数量是: [6640, 880]
../../data/5Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/5Test.csv每一类的数量是: [5600, 1400]
../../data/5Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集5测试集轮评估数据=============================================
[[119  21]
 [  4  31]]
TSS: 0.7357142857142857
本轮评估完成 
Test set: Average loss: 7.0268, Accuracy: 150/175 (86%)

[[119  21]
 [  4  31]]
data_FPR [0.11428571 0.15      ]
Recall [0.85       0.88571429]
Precision [0.96747967 0.59615385]
Accuracy [0.85714286 0.85714286]
TSS [0.73571429 0.73571429]
HSS [0.6223565 0.6223565]
FAR [0.03252033 0.40384615]
BS, BSS [0.1243929140398244, 0.22254428725109765]
数据集 5 测试集TSS: 0.7357142857142857
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/6Train.csv每一类的数量是: [15640, 2160]
../../data/6Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/6Val.csv每一类的数量是: [6640, 880]
../../data/6Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/6Test.csv每一类的数量是: [5600, 1400]
../../data/6Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集6测试集轮评估数据=============================================
[[126  14]
 [  6  29]]
TSS: 0.7285714285714286
本轮评估完成 
Test set: Average loss: 6.8471, Accuracy: 155/175 (89%)

[[126  14]
 [  6  29]]
data_FPR [0.17142857 0.1       ]
Recall [0.9        0.82857143]
Precision [0.95454545 0.6744186 ]
Accuracy [0.88571429 0.88571429]
TSS [0.72857143 0.72857143]
HSS [0.67105263 0.67105263]
FAR [0.04545455 0.3255814 ]
BS, BSS [0.11912067895587701, 0.25549575652576884]
数据集 6 测试集TSS: 0.7285714285714286
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/7Train.csv每一类的数量是: [15640, 2160]
../../data/7Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/7Val.csv每一类的数量是: [6640, 880]
../../data/7Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/7Test.csv每一类的数量是: [5600, 1400]
../../data/7Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集7测试集轮评估数据=============================================
[[106  34]
 [  1  34]]
TSS: 0.7285714285714285
本轮评估完成 
Test set: Average loss: 8.9182, Accuracy: 140/175 (80%)

[[106  34]
 [  1  34]]
data_FPR [0.02857143 0.24285714]
Recall [0.75714286 0.97142857]
Precision [0.99065421 0.5       ]
Accuracy [0.8 0.8]
TSS [0.72857143 0.72857143]
HSS [0.53825858 0.53825858]
FAR [0.00934579 0.5       ]
BS, BSS [0.1691190019038049, -0.05699376189878058]
数据集 7 测试集TSS: 0.7285714285714285
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/8Train.csv每一类的数量是: [15640, 2160]
../../data/8Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/8Val.csv每一类的数量是: [6640, 880]
../../data/8Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/8Test.csv每一类的数量是: [5600, 1400]
../../data/8Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集8测试集轮评估数据=============================================
[[116  24]
 [  5  30]]
TSS: 0.6857142857142857
本轮评估完成 
Test set: Average loss: 8.6322, Accuracy: 146/175 (83%)

[[116  24]
 [  5  30]]
data_FPR [0.14285714 0.17142857]
Recall [0.82857143 0.85714286]
Precision [0.95867769 0.55555556]
Accuracy [0.83428571 0.83428571]
TSS [0.68571429 0.68571429]
HSS [0.56973294 0.56973294]
FAR [0.04132231 0.44444444]
BS, BSS [0.15426165610745876, 0.03586464932838296]
数据集 8 测试集TSS: 0.6857142857142857
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM_VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/9Train.csv每一类的数量是: [15640, 2160]
../../data/9Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/9Val.csv每一类的数量是: [6640, 880]
../../data/9Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/9Test.csv每一类的数量是: [5600, 1400]
../../data/9Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集9测试集轮评估数据=============================================
[[102  38]
 [  3  32]]
TSS: 0.6428571428571428
本轮评估完成 
Test set: Average loss: 10.4274, Accuracy: 134/175 (77%)

[[102  38]
 [  3  32]]
data_FPR [0.08571429 0.27142857]
Recall [0.72857143 0.91428571]
Precision [0.97142857 0.45714286]
Accuracy [0.76571429 0.76571429]
TSS [0.64285714 0.64285714]
HSS [0.46753247 0.46753247]
FAR [0.02857143 0.54285714]
BS, BSS [0.18198427045422608, -0.1374016903389128]
数据集 9 测试集TSS: 0.6428571428571428
#接下来计算所有测试集指标均值和方法
结果已写入 ./model_output/2024-11-03-20-32-24/results.xlsx
程序运行时间: 0.17 分钟
lr0.001_epochs160_datasetNum9_modelTypeVIT_batchsize16_numhiddenlayers4_lr0.001_numheads5_embeddim100_hiddenunits256_numlayers2_datasetnamedata
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/0Train.csv每一类的数量是: [15640, 2160]
../../data/0Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/0Val.csv每一类的数量是: [6640, 880]
../../data/0Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/0Test.csv每一类的数量是: [5600, 1400]
../../data/0Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集0测试集轮评估数据=============================================
[[112  28]
 [  5  30]]
TSS: 0.6571428571428571
本轮评估完成 
Test set: Average loss: 7.1877, Accuracy: 142/175 (81%)

[[112  28]
 [  5  30]]
data_FPR [0.14285714 0.2       ]
Recall [0.8        0.85714286]
Precision [0.95726496 0.51724138]
Accuracy [0.81142857 0.81142857]
TSS [0.65714286 0.65714286]
HSS [0.52722063 0.52722063]
FAR [0.04273504 0.48275862]
BS, BSS [0.14019716280702746, 0.12376773245607853]
数据集 0 测试集TSS: 0.6571428571428571
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/1Train.csv每一类的数量是: [15640, 2160]
../../data/1Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/1Val.csv每一类的数量是: [6640, 880]
../../data/1Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/1Test.csv每一类的数量是: [5600, 1400]
../../data/1Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集1测试集轮评估数据=============================================
[[115  25]
 [  3  32]]
TSS: 0.7357142857142857
本轮评估完成 
Test set: Average loss: 7.4847, Accuracy: 147/175 (84%)

[[115  25]
 [  3  32]]
data_FPR [0.08571429 0.17857143]
Recall [0.82142857 0.91428571]
Precision [0.97457627 0.56140351]
Accuracy [0.84 0.84]
TSS [0.73571429 0.73571429]
HSS [0.59537572 0.59537572]
FAR [0.02542373 0.43859649]
BS, BSS [0.1433927014944646, 0.1037956156595965]
数据集 1 测试集TSS: 0.7357142857142857
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/2Train.csv每一类的数量是: [15640, 2160]
../../data/2Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/2Val.csv每一类的数量是: [6640, 880]
../../data/2Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/2Test.csv每一类的数量是: [5600, 1400]
../../data/2Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集2测试集轮评估数据=============================================
[[100  40]
 [  0  35]]
TSS: 0.7142857142857143
本轮评估完成 
Test set: Average loss: 10.4246, Accuracy: 135/175 (77%)

[[100  40]
 [  0  35]]
data_FPR [0.         0.28571429]
Recall [0.71428571 1.        ]
Precision [1.         0.46666667]
Accuracy [0.77142857 0.77142857]
TSS [0.71428571 0.71428571]
HSS [0.5 0.5]
FAR [0.         0.53333333]
BS, BSS [0.19356377325132818, -0.20977358282080094]
数据集 2 测试集TSS: 0.7142857142857143
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/3Train.csv每一类的数量是: [15640, 2160]
../../data/3Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/3Val.csv每一类的数量是: [6640, 880]
../../data/3Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/3Test.csv每一类的数量是: [5600, 1400]
../../data/3Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集3测试集轮评估数据=============================================
[[102  38]
 [  5  30]]
TSS: 0.5857142857142856
本轮评估完成 
Test set: Average loss: 7.7593, Accuracy: 132/175 (75%)

[[102  38]
 [  5  30]]
data_FPR [0.14285714 0.27142857]
Recall [0.72857143 0.85714286]
Precision [0.95327103 0.44117647]
Accuracy [0.75428571 0.75428571]
TSS [0.58571429 0.58571429]
HSS [0.43271768 0.43271768]
FAR [0.04672897 0.55882353]
BS, BSS [0.1523259083860355, 0.04796307258727839]
数据集 3 测试集TSS: 0.5857142857142856
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/4Train.csv每一类的数量是: [15640, 2160]
../../data/4Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/4Val.csv每一类的数量是: [6640, 880]
../../data/4Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/4Test.csv每一类的数量是: [5600, 1400]
../../data/4Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集4测试集轮评估数据=============================================
[[117  23]
 [  3  32]]
TSS: 0.75
本轮评估完成 
Test set: Average loss: 9.0914, Accuracy: 149/175 (85%)

[[117  23]
 [  3  32]]
data_FPR [0.08571429 0.16428571]
Recall [0.83571429 0.91428571]
Precision [0.975      0.58181818]
Accuracy [0.85142857 0.85142857]
TSS [0.75 0.75]
HSS [0.61764706 0.61764706]
FAR [0.025      0.41818182]
BS, BSS [0.1379558246025204, 0.1377760962342477]
数据集 4 测试集TSS: 0.75
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/5Train.csv每一类的数量是: [15640, 2160]
../../data/5Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/5Val.csv每一类的数量是: [6640, 880]
../../data/5Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/5Test.csv每一类的数量是: [5600, 1400]
../../data/5Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集5测试集轮评估数据=============================================
[[123  17]
 [  8  27]]
TSS: 0.65
本轮评估完成 
Test set: Average loss: 6.4766, Accuracy: 150/175 (86%)

[[123  17]
 [  8  27]]
data_FPR [0.22857143 0.12142857]
Recall [0.87857143 0.77142857]
Precision [0.9389313  0.61363636]
Accuracy [0.85714286 0.85714286]
TSS [0.65 0.65]
HSS [0.59283388 0.59283388]
FAR [0.0610687  0.38636364]
BS, BSS [0.11672047787802484, 0.2704970132623449]
数据集 5 测试集TSS: 0.65
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/6Train.csv每一类的数量是: [15640, 2160]
../../data/6Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/6Val.csv每一类的数量是: [6640, 880]
../../data/6Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/6Test.csv每一类的数量是: [5600, 1400]
../../data/6Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集6测试集轮评估数据=============================================
[[119  21]
 [  5  30]]
TSS: 0.7071428571428571
本轮评估完成 
Test set: Average loss: 6.9397, Accuracy: 149/175 (85%)

[[119  21]
 [  5  30]]
data_FPR [0.14285714 0.15      ]
Recall [0.85       0.85714286]
Precision [0.95967742 0.58823529]
Accuracy [0.85142857 0.85142857]
TSS [0.70714286 0.70714286]
HSS [0.60365854 0.60365854]
FAR [0.04032258 0.41176471]
BS, BSS [0.12488966051166009, 0.21943962180212462]
数据集 6 测试集TSS: 0.7071428571428571
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/7Train.csv每一类的数量是: [15640, 2160]
../../data/7Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/7Val.csv每一类的数量是: [6640, 880]
../../data/7Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/7Test.csv每一类的数量是: [5600, 1400]
../../data/7Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集7测试集轮评估数据=============================================
[[101  39]
 [  1  34]]
TSS: 0.6928571428571428
本轮评估完成 
Test set: Average loss: 8.5536, Accuracy: 135/175 (77%)

[[101  39]
 [  1  34]]
data_FPR [0.02857143 0.27857143]
Recall [0.72142857 0.97142857]
Precision [0.99019608 0.46575342]
Accuracy [0.77142857 0.77142857]
TSS [0.69285714 0.69285714]
HSS [0.49238579 0.49238579]
FAR [0.00980392 0.53424658]
BS, BSS [0.17059815202097678, -0.06623845013110463]
数据集 7 测试集TSS: 0.6928571428571428
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/8Train.csv每一类的数量是: [15640, 2160]
../../data/8Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/8Val.csv每一类的数量是: [6640, 880]
../../data/8Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/8Test.csv每一类的数量是: [5600, 1400]
../../data/8Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集8测试集轮评估数据=============================================
[[110  30]
 [  4  31]]
TSS: 0.6714285714285714
本轮评估完成 
Test set: Average loss: 8.5280, Accuracy: 141/175 (81%)

[[110  30]
 [  4  31]]
data_FPR [0.11428571 0.21428571]
Recall [0.78571429 0.88571429]
Precision [0.96491228 0.50819672]
Accuracy [0.80571429 0.80571429]
TSS [0.67142857 0.67142857]
HSS [0.52513966 0.52513966]
FAR [0.03508772 0.49180328]
BS, BSS [0.1458955952262049, 0.08815252983621957]
数据集 8 测试集TSS: 0.6714285714285714
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='VIT', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/9Train.csv每一类的数量是: [15640, 2160]
../../data/9Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/9Val.csv每一类的数量是: [6640, 880]
../../data/9Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/9Test.csv每一类的数量是: [5600, 1400]
../../data/9Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集9测试集轮评估数据=============================================
[[100  40]
 [  2  33]]
TSS: 0.6571428571428571
本轮评估完成 
Test set: Average loss: 10.4705, Accuracy: 133/175 (76%)

[[100  40]
 [  2  33]]
data_FPR [0.05714286 0.28571429]
Recall [0.71428571 0.94285714]
Precision [0.98039216 0.45205479]
Accuracy [0.76 0.76]
TSS [0.65714286 0.65714286]
HSS [0.46700508 0.46700508]
FAR [0.01960784 0.54794521]
BS, BSS [0.1937111887281863, -0.2106949295511642]
数据集 9 测试集TSS: 0.6571428571428571
#接下来计算所有测试集指标均值和方法
结果已写入 ./model_output/2024-11-03-20-32-34/results.xlsx
程序运行时间: 0.12 分钟
lr0.001_epochs160_datasetNum9_modelTypeLLM_batchsize16_numhiddenlayers4_lr0.001_numheads5_embeddim100_hiddenunits256_numlayers2_datasetnamedata
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/0Train.csv每一类的数量是: [15640, 2160]
../../data/0Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/0Val.csv每一类的数量是: [6640, 880]
../../data/0Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/0Test.csv每一类的数量是: [5600, 1400]
../../data/0Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集0测试集轮评估数据=============================================
[[105  35]
 [  8  27]]
TSS: 0.5214285714285715
本轮评估完成 
Test set: Average loss: 11.0267, Accuracy: 132/175 (75%)

[[105  35]
 [  8  27]]
data_FPR [0.22857143 0.25      ]
Recall [0.75       0.77142857]
Precision [0.92920354 0.43548387]
Accuracy [0.75428571 0.75428571]
TSS [0.52142857 0.52142857]
HSS [0.40443213 0.40443213]
FAR [0.07079646 0.56451613]
BS, BSS [0.24998140658285828, -0.562383791142864]
数据集 0 测试集TSS: 0.5214285714285715
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/1Train.csv每一类的数量是: [15640, 2160]
../../data/1Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/1Val.csv每一类的数量是: [6640, 880]
../../data/1Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/1Test.csv每一类的数量是: [5600, 1400]
../../data/1Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集1测试集轮评估数据=============================================
[[112  28]
 [  3  32]]
TSS: 0.7142857142857143
本轮评估完成 
Test set: Average loss: 8.8196, Accuracy: 144/175 (82%)

[[112  28]
 [  3  32]]
data_FPR [0.08571429 0.2       ]
Recall [0.8        0.91428571]
Precision [0.97391304 0.53333333]
Accuracy [0.82285714 0.82285714]
TSS [0.71428571 0.71428571]
HSS [0.56338028 0.56338028]
FAR [0.02608696 0.46666667]
BS, BSS [0.1808036783622034, -0.13002298976377102]
数据集 1 测试集TSS: 0.7142857142857143
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/2Train.csv每一类的数量是: [15640, 2160]
../../data/2Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/2Val.csv每一类的数量是: [6640, 880]
../../data/2Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/2Test.csv每一类的数量是: [5600, 1400]
../../data/2Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集2测试集轮评估数据=============================================
[[95 45]
 [ 0 35]]
TSS: 0.6785714285714286
本轮评估完成 
Test set: Average loss: 9.2953, Accuracy: 130/175 (74%)

[[95 45]
 [ 0 35]]
data_FPR [0.         0.32142857]
Recall [0.67857143 1.        ]
Precision [1.     0.4375]
Accuracy [0.74285714 0.74285714]
TSS [0.67857143 0.67857143]
HSS [0.45783133 0.45783133]
FAR [0.     0.5625]
BS, BSS [0.19656101989092584, -0.22850637431828624]
数据集 2 测试集TSS: 0.6785714285714286
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/3Train.csv每一类的数量是: [15640, 2160]
../../data/3Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/3Val.csv每一类的数量是: [6640, 880]
../../data/3Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/3Test.csv每一类的数量是: [5600, 1400]
../../data/3Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集3测试集轮评估数据=============================================
[[103  37]
 [  5  30]]
TSS: 0.5928571428571429
本轮评估完成 
Test set: Average loss: 10.7302, Accuracy: 133/175 (76%)

[[103  37]
 [  5  30]]
data_FPR [0.14285714 0.26428571]
Recall [0.73571429 0.85714286]
Precision [0.9537037  0.44776119]
Accuracy [0.76 0.76]
TSS [0.59285714 0.59285714]
HSS [0.44148936 0.44148936]
FAR [0.0462963  0.55223881]
BS, BSS [0.22469520461789907, -0.40434502886186885]
数据集 3 测试集TSS: 0.5928571428571429
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/4Train.csv每一类的数量是: [15640, 2160]
../../data/4Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/4Val.csv每一类的数量是: [6640, 880]
../../data/4Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/4Test.csv每一类的数量是: [5600, 1400]
../../data/4Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集4测试集轮评估数据=============================================
[[99 41]
 [ 6 29]]
TSS: 0.5357142857142858
本轮评估完成 
Test set: Average loss: 9.5654, Accuracy: 128/175 (73%)

[[99 41]
 [ 6 29]]
data_FPR [0.17142857 0.29285714]
Recall [0.70714286 0.82857143]
Precision [0.94285714 0.41428571]
Accuracy [0.73142857 0.73142857]
TSS [0.53571429 0.53571429]
HSS [0.38961039 0.38961039]
FAR [0.05714286 0.58571429]
BS, BSS [0.2049932181622404, -0.28120761351400225]
数据集 4 测试集TSS: 0.5357142857142858
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/5Train.csv每一类的数量是: [15640, 2160]
../../data/5Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/5Val.csv每一类的数量是: [6640, 880]
../../data/5Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/5Test.csv每一类的数量是: [5600, 1400]
../../data/5Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集5测试集轮评估数据=============================================
[[129  11]
 [ 15  20]]
TSS: 0.49285714285714277
本轮评估完成 
Test set: Average loss: 9.3318, Accuracy: 149/175 (85%)

[[129  11]
 [ 15  20]]
data_FPR [0.42857143 0.07857143]
Recall [0.92142857 0.57142857]
Precision [0.89583333 0.64516129]
Accuracy [0.85142857 0.85142857]
TSS [0.49285714 0.49285714]
HSS [0.51492537 0.51492537]
FAR [0.10416667 0.35483871]
BS, BSS [0.19227366478304053, -0.20171040489400305]
数据集 5 测试集TSS: 0.49285714285714277
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/6Train.csv每一类的数量是: [15640, 2160]
../../data/6Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/6Val.csv每一类的数量是: [6640, 880]
../../data/6Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/6Test.csv每一类的数量是: [5600, 1400]
../../data/6Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集6测试集轮评估数据=============================================
[[100  40]
 [  5  30]]
TSS: 0.5714285714285714
本轮评估完成 
Test set: Average loss: 9.0597, Accuracy: 130/175 (74%)

[[100  40]
 [  5  30]]
data_FPR [0.14285714 0.28571429]
Recall [0.71428571 0.85714286]
Precision [0.95238095 0.42857143]
Accuracy [0.74285714 0.74285714]
TSS [0.57142857 0.57142857]
HSS [0.41558442 0.41558442]
FAR [0.04761905 0.57142857]
BS, BSS [0.19050693870324276, -0.1906683668952669]
数据集 6 测试集TSS: 0.5714285714285714
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/7Train.csv每一类的数量是: [15640, 2160]
../../data/7Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/7Val.csv每一类的数量是: [6640, 880]
../../data/7Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/7Test.csv每一类的数量是: [5600, 1400]
../../data/7Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集7测试集轮评估数据=============================================
[[109  31]
 [  4  31]]
TSS: 0.6642857142857143
本轮评估完成 
Test set: Average loss: 10.7717, Accuracy: 140/175 (80%)

[[109  31]
 [  4  31]]
data_FPR [0.11428571 0.22142857]
Recall [0.77857143 0.88571429]
Precision [0.96460177 0.5       ]
Accuracy [0.8 0.8]
TSS [0.66428571 0.66428571]
HSS [0.51523546 0.51523546]
FAR [0.03539823 0.5       ]
BS, BSS [0.23559103502949436, -0.4724439689343394]
数据集 7 测试集TSS: 0.6642857142857143
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/8Train.csv每一类的数量是: [15640, 2160]
../../data/8Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/8Val.csv每一类的数量是: [6640, 880]
../../data/8Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/8Test.csv每一类的数量是: [5600, 1400]
../../data/8Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集8测试集轮评估数据=============================================
[[95 45]
 [ 3 32]]
TSS: 0.5928571428571429
本轮评估完成 
Test set: Average loss: 11.1129, Accuracy: 127/175 (73%)

[[95 45]
 [ 3 32]]
data_FPR [0.08571429 0.32142857]
Recall [0.67857143 0.91428571]
Precision [0.96938776 0.41558442]
Accuracy [0.72571429 0.72571429]
TSS [0.59285714 0.59285714]
HSS [0.408867 0.408867]
FAR [0.03061224 0.58441558]
BS, BSS [0.2513118236837778, -0.570698898023611]
数据集 8 测试集TSS: 0.5928571428571429
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LLM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/9Train.csv每一类的数量是: [15640, 2160]
../../data/9Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/9Val.csv每一类的数量是: [6640, 880]
../../data/9Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/9Test.csv每一类的数量是: [5600, 1400]
../../data/9Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集9测试集轮评估数据=============================================
[[101  39]
 [  2  33]]
TSS: 0.6642857142857143
本轮评估完成 
Test set: Average loss: 11.0003, Accuracy: 134/175 (77%)

[[101  39]
 [  2  33]]
data_FPR [0.05714286 0.27857143]
Recall [0.72142857 0.94285714]
Precision [0.98058252 0.45833333]
Accuracy [0.76571429 0.76571429]
TSS [0.66428571 0.66428571]
HSS [0.47570332 0.47570332]
FAR [0.01941748 0.54166667]
BS, BSS [0.21560772522325558, -0.3475482826453471]
数据集 9 测试集TSS: 0.6642857142857143
#接下来计算所有测试集指标均值和方法
结果已写入 ./model_output/2024-11-03-20-32-41/results.xlsx
程序运行时间: 0.13 分钟
lr0.001_epochs160_datasetNum9_modelTypeLSTM_batchsize16_numhiddenlayers4_lr0.001_numheads5_embeddim100_hiddenunits256_numlayers2_datasetnamedata
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/0Train.csv每一类的数量是: [15640, 2160]
../../data/0Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/0Val.csv每一类的数量是: [6640, 880]
../../data/0Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/0Test.csv每一类的数量是: [5600, 1400]
../../data/0Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集0测试集轮评估数据=============================================
[[100  40]
 [  2  33]]
TSS: 0.6571428571428571
本轮评估完成 
Test set: Average loss: 8.5806, Accuracy: 133/175 (76%)

[[100  40]
 [  2  33]]
data_FPR [0.05714286 0.28571429]
Recall [0.71428571 0.94285714]
Precision [0.98039216 0.45205479]
Accuracy [0.76 0.76]
TSS [0.65714286 0.65714286]
HSS [0.46700508 0.46700508]
FAR [0.01960784 0.54794521]
BS, BSS [0.16953538357466438, -0.059596147341652195]
数据集 0 测试集TSS: 0.6571428571428571
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/1Train.csv每一类的数量是: [15640, 2160]
../../data/1Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/1Val.csv每一类的数量是: [6640, 880]
../../data/1Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/1Test.csv每一类的数量是: [5600, 1400]
../../data/1Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集1测试集轮评估数据=============================================
[[109  31]
 [  1  34]]
TSS: 0.75
本轮评估完成 
Test set: Average loss: 8.1570, Accuracy: 143/175 (82%)

[[109  31]
 [  1  34]]
data_FPR [0.02857143 0.22142857]
Recall [0.77857143 0.97142857]
Precision [0.99090909 0.52307692]
Accuracy [0.81714286 0.81714286]
TSS [0.75 0.75]
HSS [0.56756757 0.56756757]
FAR [0.00909091 0.47692308]
BS, BSS [0.1594136727911467, 0.0036645450553332015]
数据集 1 测试集TSS: 0.75
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/2Train.csv每一类的数量是: [15640, 2160]
../../data/2Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/2Val.csv每一类的数量是: [6640, 880]
../../data/2Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/2Test.csv每一类的数量是: [5600, 1400]
../../data/2Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集2测试集轮评估数据=============================================
[[113  27]
 [  1  34]]
TSS: 0.7785714285714286
本轮评估完成 
Test set: Average loss: 8.3450, Accuracy: 147/175 (84%)

[[113  27]
 [  1  34]]
data_FPR [0.02857143 0.19285714]
Recall [0.80714286 0.97142857]
Precision [0.99122807 0.55737705]
Accuracy [0.84 0.84]
TSS [0.77857143 0.77857143]
HSS [0.60893855 0.60893855]
FAR [0.00877193 0.44262295]
BS, BSS [0.15301914485343834, 0.04363034466601057]
数据集 2 测试集TSS: 0.7785714285714286
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/3Train.csv每一类的数量是: [15640, 2160]
../../data/3Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/3Val.csv每一类的数量是: [6640, 880]
../../data/3Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/3Test.csv每一类的数量是: [5600, 1400]
../../data/3Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集3测试集轮评估数据=============================================
[[99 41]
 [ 4 31]]
TSS: 0.5928571428571429
本轮评估完成 
Test set: Average loss: 8.3535, Accuracy: 130/175 (74%)

[[99 41]
 [ 4 31]]
data_FPR [0.11428571 0.29285714]
Recall [0.70714286 0.88571429]
Precision [0.96116505 0.43055556]
Accuracy [0.74285714 0.74285714]
TSS [0.59285714 0.59285714]
HSS [0.42455243 0.42455243]
FAR [0.03883495 0.56944444]
BS, BSS [0.17156425855215496, -0.07227661595096824]
数据集 3 测试集TSS: 0.5928571428571429
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/4Train.csv每一类的数量是: [15640, 2160]
../../data/4Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/4Val.csv每一类的数量是: [6640, 880]
../../data/4Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/4Test.csv每一类的数量是: [5600, 1400]
../../data/4Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集4测试集轮评估数据=============================================
[[125  15]
 [  9  26]]
TSS: 0.6357142857142858
本轮评估完成 
Test set: Average loss: 7.9379, Accuracy: 151/175 (86%)

[[125  15]
 [  9  26]]
data_FPR [0.25714286 0.10714286]
Recall [0.89285714 0.74285714]
Precision [0.93283582 0.63414634]
Accuracy [0.86285714 0.86285714]
TSS [0.63571429 0.63571429]
HSS [0.59731544 0.59731544]
FAR [0.06716418 0.36585366]
BS, BSS [0.15549789877012576, 0.028138132686714168]
数据集 4 测试集TSS: 0.6357142857142858
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/5Train.csv每一类的数量是: [15640, 2160]
../../data/5Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/5Val.csv每一类的数量是: [6640, 880]
../../data/5Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/5Test.csv每一类的数量是: [5600, 1400]
../../data/5Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集5测试集轮评估数据=============================================
[[111  29]
 [  1  34]]
TSS: 0.7642857142857142
本轮评估完成 
Test set: Average loss: 9.0503, Accuracy: 145/175 (83%)

[[111  29]
 [  1  34]]
data_FPR [0.02857143 0.20714286]
Recall [0.79285714 0.97142857]
Precision [0.99107143 0.53968254]
Accuracy [0.82857143 0.82857143]
TSS [0.76428571 0.76428571]
HSS [0.58791209 0.58791209]
FAR [0.00892857 0.46031746]
BS, BSS [0.17431489370752964, -0.08946808567206]
数据集 5 测试集TSS: 0.7642857142857142
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/6Train.csv每一类的数量是: [15640, 2160]
../../data/6Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/6Val.csv每一类的数量是: [6640, 880]
../../data/6Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/6Test.csv每一类的数量是: [5600, 1400]
../../data/6Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集6测试集轮评估数据=============================================
[[103  37]
 [  1  34]]
TSS: 0.7071428571428572
本轮评估完成 
Test set: Average loss: 7.9970, Accuracy: 137/175 (78%)

[[103  37]
 [  1  34]]
data_FPR [0.02857143 0.26428571]
Recall [0.73571429 0.97142857]
Precision [0.99038462 0.47887324]
Accuracy [0.78285714 0.78285714]
TSS [0.70714286 0.70714286]
HSS [0.51030928 0.51030928]
FAR [0.00961538 0.52112676]
BS, BSS [0.16209606908265906, -0.013100431766618792]
数据集 6 测试集TSS: 0.7071428571428572
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/7Train.csv每一类的数量是: [15640, 2160]
../../data/7Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/7Val.csv每一类的数量是: [6640, 880]
../../data/7Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/7Test.csv每一类的数量是: [5600, 1400]
../../data/7Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集7测试集轮评估数据=============================================
[[109  31]
 [  1  34]]
TSS: 0.75
本轮评估完成 
Test set: Average loss: 8.9957, Accuracy: 143/175 (82%)

[[109  31]
 [  1  34]]
data_FPR [0.02857143 0.22142857]
Recall [0.77857143 0.97142857]
Precision [0.99090909 0.52307692]
Accuracy [0.81714286 0.81714286]
TSS [0.75 0.75]
HSS [0.56756757 0.56756757]
FAR [0.00909091 0.47692308]
BS, BSS [0.18023285215871562, -0.1264553259919725]
数据集 7 测试集TSS: 0.75
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/8Train.csv每一类的数量是: [15640, 2160]
../../data/8Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/8Val.csv每一类的数量是: [6640, 880]
../../data/8Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/8Test.csv每一类的数量是: [5600, 1400]
../../data/8Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集8测试集轮评估数据=============================================
[[107  33]
 [  2  33]]
TSS: 0.7071428571428571
本轮评估完成 
Test set: Average loss: 8.4198, Accuracy: 140/175 (80%)

[[107  33]
 [  2  33]]
data_FPR [0.05714286 0.23571429]
Recall [0.76428571 0.94285714]
Precision [0.98165138 0.5       ]
Accuracy [0.8 0.8]
TSS [0.70714286 0.70714286]
HSS [0.5308311 0.5308311]
FAR [0.01834862 0.5       ]
BS, BSS [0.1599959546340051, 2.528353746833467e-05]
数据集 8 测试集TSS: 0.7071428571428571
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/9Train.csv每一类的数量是: [15640, 2160]
../../data/9Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/9Val.csv每一类的数量是: [6640, 880]
../../data/9Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/9Test.csv每一类的数量是: [5600, 1400]
../../data/9Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
====================数据集9测试集轮评估数据=============================================
[[93 47]
 [ 1 34]]
TSS: 0.6357142857142857
本轮评估完成 
Test set: Average loss: 10.0691, Accuracy: 127/175 (73%)

[[93 47]
 [ 1 34]]
data_FPR [0.02857143 0.33571429]
Recall [0.66428571 0.97142857]
Precision [0.9893617  0.41975309]
Accuracy [0.72571429 0.72571429]
TSS [0.63571429 0.63571429]
HSS [0.42583732 0.42583732]
FAR [0.0106383  0.58024691]
BS, BSS [0.2047171843039159, -0.27948240189947415]
数据集 9 测试集TSS: 0.6357142857142857
#接下来计算所有测试集指标均值和方法
结果已写入 ./model_output/2024-11-03-20-32-49/results.xlsx
程序运行时间: 0.12 分钟
