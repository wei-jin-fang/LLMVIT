Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM_new', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/0Train.csv每一类的数量是: [15640, 2160]
../../data/0Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/0Val.csv每一类的数量是: [6640, 880]
../../data/0Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/0Test.csv每一类的数量是: [5600, 1400]
../../data/0Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
train_x.shape : (445, 40, 10) 
train_y.shape : (445,) 
validate_x.shape : (188, 40, 10) 
validate_y.shape : (188,) 
test_x.shape : (175, 40, 10) 
test_y.shape : (175,) 
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=80, epochs=200, hidden_units=512, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=2, num_hidden_layers=4, num_layers=2, optim='Adam', print=0, seed=2021)
====================数据集0测试集轮评估数据=============================================
[[95 45]
 [ 5 30]]
TSS: 0.5357142857142857
本轮评估完成 
Test set: Average loss: 9.8259, Accuracy: 125/175 (71%)

[[95 45]
 [ 5 30]]
data_FPR [0.14285714 0.32142857]
Recall [0.67857143 0.85714286]
Precision [0.95 0.4 ]
Accuracy [0.71428571 0.71428571]
TSS [0.53571429 0.53571429]
HSS [0.375 0.375]
FAR [0.05 0.6 ]
BS, BSS [0.21147631303871062, -0.32172695649194116]
数据集 0 测试集TSS: 0.5357142857142857
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM_new', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/1Train.csv每一类的数量是: [15640, 2160]
../../data/1Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/1Val.csv每一类的数量是: [6640, 880]
../../data/1Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/1Test.csv每一类的数量是: [5600, 1400]
../../data/1Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=80, epochs=200, hidden_units=512, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=2, num_hidden_layers=4, num_layers=2, optim='Adam', print=0, seed=2021)
====================数据集1测试集轮评估数据=============================================
[[86 54]
 [ 0 35]]
TSS: 0.6142857142857143
本轮评估完成 
Test set: Average loss: 8.9634, Accuracy: 121/175 (69%)

[[86 54]
 [ 0 35]]
data_FPR [0.         0.38571429]
Recall [0.61428571 1.        ]
Precision [1.         0.39325843]
Accuracy [0.69142857 0.69142857]
TSS [0.61428571 0.61428571]
HSS [0.38914027 0.38914027]
FAR [0.         0.60674157]
BS, BSS [0.18768162760712917, -0.1730101725445572]
数据集 1 测试集TSS: 0.6142857142857143
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM_new', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/2Train.csv每一类的数量是: [15640, 2160]
../../data/2Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/2Val.csv每一类的数量是: [6640, 880]
../../data/2Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/2Test.csv每一类的数量是: [5600, 1400]
../../data/2Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=80, epochs=200, hidden_units=512, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=2, num_hidden_layers=4, num_layers=2, optim='Adam', print=0, seed=2021)
====================数据集2测试集轮评估数据=============================================
[[100  40]
 [  0  35]]
TSS: 0.7142857142857143
本轮评估完成 
Test set: Average loss: 8.6645, Accuracy: 135/175 (77%)

[[100  40]
 [  0  35]]
data_FPR [0.         0.28571429]
Recall [0.71428571 1.        ]
Precision [1.         0.46666667]
Accuracy [0.77142857 0.77142857]
TSS [0.71428571 0.71428571]
HSS [0.5 0.5]
FAR [0.         0.53333333]
BS, BSS [0.17998605671467255, -0.1249128544667033]
数据集 2 测试集TSS: 0.7142857142857143
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM_new', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/3Train.csv每一类的数量是: [15640, 2160]
../../data/3Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/3Val.csv每一类的数量是: [6640, 880]
../../data/3Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/3Test.csv每一类的数量是: [5600, 1400]
../../data/3Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=80, epochs=200, hidden_units=512, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=2, num_hidden_layers=4, num_layers=2, optim='Adam', print=0, seed=2021)
====================数据集3测试集轮评估数据=============================================
[[117  23]
 [  5  30]]
TSS: 0.6928571428571428
本轮评估完成 
Test set: Average loss: 7.5335, Accuracy: 147/175 (84%)

[[117  23]
 [  5  30]]
data_FPR [0.14285714 0.16428571]
Recall [0.83571429 0.85714286]
Precision [0.95901639 0.56603774]
Accuracy [0.84 0.84]
TSS [0.69285714 0.69285714]
HSS [0.58083832 0.58083832]
FAR [0.04098361 0.43396226]
BS, BSS [0.14566829652855612, 0.08957314669652439]
数据集 3 测试集TSS: 0.6928571428571428
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM_new', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/4Train.csv每一类的数量是: [15640, 2160]
../../data/4Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/4Val.csv每一类的数量是: [6640, 880]
../../data/4Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/4Test.csv每一类的数量是: [5600, 1400]
../../data/4Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=80, epochs=200, hidden_units=512, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=2, num_hidden_layers=4, num_layers=2, optim='Adam', print=0, seed=2021)
====================数据集4测试集轮评估数据=============================================
[[112  28]
 [  1  34]]
TSS: 0.7714285714285715
本轮评估完成 
Test set: Average loss: 7.7297, Accuracy: 146/175 (83%)

[[112  28]
 [  1  34]]
data_FPR [0.02857143 0.2       ]
Recall [0.8        0.97142857]
Precision [0.99115044 0.5483871 ]
Accuracy [0.83428571 0.83428571]
TSS [0.77142857 0.77142857]
HSS [0.59833795 0.59833795]
FAR [0.00884956 0.4516129 ]
BS, BSS [0.14686194675998357, 0.08211283275010284]
数据集 4 测试集TSS: 0.7714285714285715
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM_new', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/5Train.csv每一类的数量是: [15640, 2160]
../../data/5Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/5Val.csv每一类的数量是: [6640, 880]
../../data/5Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/5Test.csv每一类的数量是: [5600, 1400]
../../data/5Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=80, epochs=200, hidden_units=512, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=2, num_hidden_layers=4, num_layers=2, optim='Adam', print=0, seed=2021)
====================数据集5测试集轮评估数据=============================================
[[132   8]
 [ 15  20]]
TSS: 0.5142857142857142
本轮评估完成 
Test set: Average loss: 8.9132, Accuracy: 152/175 (87%)

[[132   8]
 [ 15  20]]
data_FPR [0.42857143 0.05714286]
Recall [0.94285714 0.57142857]
Precision [0.89795918 0.71428571]
Accuracy [0.86857143 0.86857143]
TSS [0.51428571 0.51428571]
HSS [0.55598456 0.55598456]
FAR [0.10204082 0.28571429]
BS, BSS [0.1839951006587794, -0.14996937911737085]
数据集 5 测试集TSS: 0.5142857142857142
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM_new', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/6Train.csv每一类的数量是: [15640, 2160]
../../data/6Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/6Val.csv每一类的数量是: [6640, 880]
../../data/6Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/6Test.csv每一类的数量是: [5600, 1400]
../../data/6Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=80, epochs=200, hidden_units=512, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=2, num_hidden_layers=4, num_layers=2, optim='Adam', print=0, seed=2021)
====================数据集6测试集轮评估数据=============================================
[[123  17]
 [ 10  25]]
TSS: 0.5928571428571429
本轮评估完成 
Test set: Average loss: 8.1378, Accuracy: 148/175 (85%)

[[123  17]
 [ 10  25]]
data_FPR [0.28571429 0.12142857]
Recall [0.87857143 0.71428571]
Precision [0.92481203 0.5952381 ]
Accuracy [0.84571429 0.84571429]
TSS [0.59285714 0.59285714]
HSS [0.55149502 0.55149502]
FAR [0.07518797 0.4047619 ]
BS, BSS [0.16151066133040393, -0.009441633315024234]
数据集 6 测试集TSS: 0.5928571428571429
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM_new', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/7Train.csv每一类的数量是: [15640, 2160]
../../data/7Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/7Val.csv每一类的数量是: [6640, 880]
../../data/7Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/7Test.csv每一类的数量是: [5600, 1400]
../../data/7Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=80, epochs=200, hidden_units=512, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=2, num_hidden_layers=4, num_layers=2, optim='Adam', print=0, seed=2021)
====================数据集7测试集轮评估数据=============================================
[[116  24]
 [  8  27]]
TSS: 0.6000000000000001
本轮评估完成 
Test set: Average loss: 8.1975, Accuracy: 143/175 (82%)

[[116  24]
 [  8  27]]
data_FPR [0.22857143 0.17142857]
Recall [0.82857143 0.77142857]
Precision [0.93548387 0.52941176]
Accuracy [0.81714286 0.81714286]
TSS [0.6 0.6]
HSS [0.51219512 0.51219512]
FAR [0.06451613 0.47058824]
BS, BSS [0.166332544902473, -0.03957840564045623]
数据集 7 测试集TSS: 0.6000000000000001
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM_new', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/8Train.csv每一类的数量是: [15640, 2160]
../../data/8Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/8Val.csv每一类的数量是: [6640, 880]
../../data/8Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/8Test.csv每一类的数量是: [5600, 1400]
../../data/8Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=80, epochs=200, hidden_units=512, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=2, num_hidden_layers=4, num_layers=2, optim='Adam', print=0, seed=2021)
====================数据集8测试集轮评估数据=============================================
[[115  25]
 [  3  32]]
TSS: 0.7357142857142857
本轮评估完成 
Test set: Average loss: 8.6205, Accuracy: 147/175 (84%)

[[115  25]
 [  3  32]]
data_FPR [0.08571429 0.17857143]
Recall [0.82142857 0.91428571]
Precision [0.97457627 0.56140351]
Accuracy [0.84 0.84]
TSS [0.73571429 0.73571429]
HSS [0.59537572 0.59537572]
FAR [0.02542373 0.43859649]
BS, BSS [0.15694358754316048, 0.01910257785524716]
数据集 8 测试集TSS: 0.7357142857142857
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM_new', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
../../data/9Train.csv每一类的数量是: [15640, 2160]
../../data/9Train.csvget_Class函数得到的的权重： [0.5690537084398977, 4.12037037037037]
../../data/9Val.csv每一类的数量是: [6640, 880]
../../data/9Val.csvget_Class函数得到的的权重： [0.5662650602409639, 4.2727272727272725]
../../data/9Test.csv每一类的数量是: [5600, 1400]
../../data/9Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(17800, 1)
(445,)
(7520, 1)
(188,)
(7000, 1)
(175,)
zero: 0.5690537084398977
zero: 4.12037037037037
{0.0: 0.5690537084398977, 1.0: 4.12037037037037}
Namespace(batch_size=16, cuda=True, datasetname='data', dropout=0.5, embed='timeF', embed_dim=80, epochs=200, hidden_units=512, log_interval=100, lr=0.001, model_type='LSTM', num_dataset=9, num_heads=2, num_hidden_layers=4, num_layers=2, optim='Adam', print=0, seed=2021)
====================数据集9测试集轮评估数据=============================================
[[97 43]
 [ 3 32]]
TSS: 0.6071428571428571
本轮评估完成 
Test set: Average loss: 10.5389, Accuracy: 129/175 (74%)

[[97 43]
 [ 3 32]]
data_FPR [0.08571429 0.30714286]
Recall [0.69285714 0.91428571]
Precision [0.97       0.42666667]
Accuracy [0.73714286 0.73714286]
TSS [0.60714286 0.60714286]
HSS [0.425 0.425]
FAR [0.03       0.57333333]
BS, BSS [0.20570219600075454, -0.28563872500471565]
数据集 9 测试集TSS: 0.6071428571428571
#接下来计算所有测试集指标均值和方法
结果已写入 ./model_output/2025-05-09-11-21-26/results.xlsx
程序运行时间: 0.15 分钟
