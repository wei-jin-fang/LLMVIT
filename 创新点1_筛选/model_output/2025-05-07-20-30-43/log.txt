Namespace(batch_size=16, cuda=True, datasetname='data筛选', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM_new', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
./data筛选/0Test.csv每一类的数量是: [3640, 800]
./data筛选/0Test.csvget_Class函数得到的的权重： [0.6098901098901099, 2.775]
./data筛选/0Test.csv每一类的数量是: [3640, 800]
./data筛选/0Test.csvget_Class函数得到的的权重： [0.6098901098901099, 2.775]
./data筛选/0Test.csv每一类的数量是: [3640, 800]
./data筛选/0Test.csvget_Class函数得到的的权重： [0.6098901098901099, 2.775]
(4440, 10)
(111, 40, 10)
(4440, 1)
(111,)
(4440, 1)
(111,)
(4440, 1)
(111,)
train_x.shape : (111, 40, 10) 
train_y.shape : (111,) 
validate_x.shape : (111, 40, 10) 
validate_y.shape : (111,) 
test_x.shape : (111, 40, 10) 
test_y.shape : (111,) 
zero: 0.6098901098901099
zero: 2.775
{0.0: 0.6098901098901099, 1.0: 2.775}
====================数据集0测试集轮评估数据=============================================
[[78 13]
 [ 3 17]]
TSS: 0.7071428571428571
本轮评估完成 
Test set: Average loss: 7.3457, Accuracy: 95/111 (86%)

[[78 13]
 [ 3 17]]
Recall [0.85714286 0.85      ]
Precision [0.96296296 0.56666667]
Accuracy [0.85585586 0.85585586]
TSS [0.70714286 0.70714286]
HSS [0.59172414 0.59172414]
FAR [0.03703704 0.43333333]
data_FPR [0.15       0.14285714]
BS, BSS [0.14116690568564966, 0.04433107420170879]
数据集 0 测试集TSS: 0.7071428571428571
Namespace(batch_size=16, cuda=True, datasetname='data筛选', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM_new', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
./data筛选/1Test.csv每一类的数量是: [4000, 760]
./data筛选/1Test.csvget_Class函数得到的的权重： [0.595, 3.1315789473684212]
./data筛选/1Test.csv每一类的数量是: [4000, 760]
./data筛选/1Test.csvget_Class函数得到的的权重： [0.595, 3.1315789473684212]
./data筛选/1Test.csv每一类的数量是: [4000, 760]
./data筛选/1Test.csvget_Class函数得到的的权重： [0.595, 3.1315789473684212]
(4760, 10)
(119, 40, 10)
(4760, 1)
(119,)
(4760, 1)
(119,)
(4760, 1)
(119,)
zero: 0.595
zero: 3.1315789473684212
{0.0: 0.595, 1.0: 3.1315789473684212}
====================数据集1测试集轮评估数据=============================================
[[71 29]
 [ 0 19]]
TSS: 0.71
本轮评估完成 
Test set: Average loss: 7.5445, Accuracy: 90/119 (76%)

[[71 29]
 [ 0 19]]
Recall [0.71 1.  ]
Precision [1.         0.39583333]
Accuracy [0.75630252 0.75630252]
TSS [0.71 0.71]
HSS [0.43877053 0.43877053]
FAR [0.         0.60416667]
data_FPR [0.   0.29]
BS, BSS [0.16158653395184916, -0.20432995120638764]
数据集 1 测试集TSS: 0.71
Namespace(batch_size=16, cuda=True, datasetname='data筛选', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM_new', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
./data筛选/2Test.csv每一类的数量是: [3560, 720]
./data筛选/2Test.csvget_Class函数得到的的权重： [0.601123595505618, 2.9722222222222223]
./data筛选/2Test.csv每一类的数量是: [3560, 720]
./data筛选/2Test.csvget_Class函数得到的的权重： [0.601123595505618, 2.9722222222222223]
./data筛选/2Test.csv每一类的数量是: [3560, 720]
./data筛选/2Test.csvget_Class函数得到的的权重： [0.601123595505618, 2.9722222222222223]
(4280, 10)
(107, 40, 10)
(4280, 1)
(107,)
(4280, 1)
(107,)
(4280, 1)
(107,)
zero: 0.601123595505618
zero: 2.9722222222222223
{0.0: 0.601123595505618, 1.0: 2.9722222222222223}
====================数据集2测试集轮评估数据=============================================
[[77 12]
 [ 0 18]]
TSS: 0.8651685393258427
本轮评估完成 
Test set: Average loss: 6.4320, Accuracy: 95/107 (89%)

[[77 12]
 [ 0 18]]
Recall [0.86516854 1.        ]
Precision [1.  0.6]
Accuracy [0.88785047 0.88785047]
TSS [0.86516854 0.86516854]
HSS [0.68343195 0.68343195]
FAR [0.  0.4]
data_FPR [0.         0.13483146]
BS, BSS [0.12351293426702357, 0.11729114580327515]
数据集 2 测试集TSS: 0.8651685393258427
Namespace(batch_size=16, cuda=True, datasetname='data筛选', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM_new', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
./data筛选/3Test.csv每一类的数量是: [3280, 880]
./data筛选/3Test.csvget_Class函数得到的的权重： [0.6341463414634146, 2.3636363636363638]
./data筛选/3Test.csv每一类的数量是: [3280, 880]
./data筛选/3Test.csvget_Class函数得到的的权重： [0.6341463414634146, 2.3636363636363638]
./data筛选/3Test.csv每一类的数量是: [3280, 880]
./data筛选/3Test.csvget_Class函数得到的的权重： [0.6341463414634146, 2.3636363636363638]
(4160, 10)
(104, 40, 10)
(4160, 1)
(104,)
(4160, 1)
(104,)
(4160, 1)
(104,)
zero: 0.6341463414634146
zero: 2.3636363636363638
{0.0: 0.6341463414634146, 1.0: 2.3636363636363638}
====================数据集3测试集轮评估数据=============================================
[[76  6]
 [ 4 18]]
TSS: 0.7450110864745012
本轮评估完成 
Test set: Average loss: 5.6403, Accuracy: 94/104 (90%)

[[76  6]
 [ 4 18]]
Recall [0.92682927 0.81818182]
Precision [0.95 0.75]
Accuracy [0.90384615 0.90384615]
TSS [0.74501109 0.74501109]
HSS [0.72103004 0.72103004]
FAR [0.05 0.25]
data_FPR [0.18181818 0.07317073]
BS, BSS [0.10552545457221285, 0.3673152346712558]
数据集 3 测试集TSS: 0.7450110864745012
Namespace(batch_size=16, cuda=True, datasetname='data筛选', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM_new', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
./data筛选/4Test.csv每一类的数量是: [3440, 680]
./data筛选/4Test.csvget_Class函数得到的的权重： [0.5988372093023255, 3.0294117647058822]
./data筛选/4Test.csv每一类的数量是: [3440, 680]
./data筛选/4Test.csvget_Class函数得到的的权重： [0.5988372093023255, 3.0294117647058822]
./data筛选/4Test.csv每一类的数量是: [3440, 680]
./data筛选/4Test.csvget_Class函数得到的的权重： [0.5988372093023255, 3.0294117647058822]
(4120, 10)
(103, 40, 10)
(4120, 1)
(103,)
(4120, 1)
(103,)
(4120, 1)
(103,)
zero: 0.5988372093023255
zero: 3.0294117647058822
{0.0: 0.5988372093023255, 1.0: 3.0294117647058822}
====================数据集4测试集轮评估数据=============================================
[[80  6]
 [ 1 16]]
TSS: 0.8714090287277702
本轮评估完成 
Test set: Average loss: 5.0435, Accuracy: 96/103 (93%)

[[80  6]
 [ 1 16]]
Recall [0.93023256 0.94117647]
Precision [0.98765432 0.72727273]
Accuracy [0.93203883 0.93203883]
TSS [0.87140903 0.87140903]
HSS [0.77944325 0.77944325]
FAR [0.01234568 0.27272727]
data_FPR [0.05882353 0.06976744]
BS, BSS [0.09312735582217682, 0.3242215335721793]
数据集 4 测试集TSS: 0.8714090287277702
Namespace(batch_size=16, cuda=True, datasetname='data筛选', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM_new', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
./data筛选/5Test.csv每一类的数量是: [3200, 800]
./data筛选/5Test.csvget_Class函数得到的的权重： [0.625, 2.5]
./data筛选/5Test.csv每一类的数量是: [3200, 800]
./data筛选/5Test.csvget_Class函数得到的的权重： [0.625, 2.5]
./data筛选/5Test.csv每一类的数量是: [3200, 800]
./data筛选/5Test.csvget_Class函数得到的的权重： [0.625, 2.5]
(4000, 10)
(100, 40, 10)
(4000, 1)
(100,)
(4000, 1)
(100,)
(4000, 1)
(100,)
zero: 0.625
zero: 2.5
{0.0: 0.625, 1.0: 2.5}
====================数据集5测试集轮评估数据=============================================
[[77  3]
 [ 6 14]]
TSS: 0.6625
本轮评估完成 
Test set: Average loss: 7.4842, Accuracy: 91/100 (91%)

[[77  3]
 [ 6 14]]
Recall [0.9625 0.7   ]
Precision [0.92771084 0.82352941]
Accuracy [0.91 0.91]
TSS [0.6625 0.6625]
HSS [0.70198675 0.70198675]
FAR [0.07228916 0.17647059]
data_FPR [0.3    0.0375]
BS, BSS [0.16777079252785915, -0.04856745329911938]
数据集 5 测试集TSS: 0.6625
Namespace(batch_size=16, cuda=True, datasetname='data筛选', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM_new', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
./data筛选/6Test.csv每一类的数量是: [3880, 800]
./data筛选/6Test.csvget_Class函数得到的的权重： [0.6030927835051546, 2.925]
./data筛选/6Test.csv每一类的数量是: [3880, 800]
./data筛选/6Test.csvget_Class函数得到的的权重： [0.6030927835051546, 2.925]
./data筛选/6Test.csv每一类的数量是: [3880, 800]
./data筛选/6Test.csvget_Class函数得到的的权重： [0.6030927835051546, 2.925]
(4680, 10)
(117, 40, 10)
(4680, 1)
(117,)
(4680, 1)
(117,)
(4680, 1)
(117,)
zero: 0.6030927835051546
zero: 2.925
{0.0: 0.6030927835051546, 1.0: 2.925}
====================数据集6测试集轮评估数据=============================================
[[93  4]
 [ 7 13]]
TSS: 0.6087628865979382
本轮评估完成 
Test set: Average loss: 6.5049, Accuracy: 106/117 (91%)

[[93  4]
 [ 7 13]]
Recall [0.95876289 0.65      ]
Precision [0.93       0.76470588]
Accuracy [0.90598291 0.90598291]
TSS [0.60876289 0.60876289]
HSS [0.64730063 0.64730063]
FAR [0.07       0.23529412]
data_FPR [0.35       0.04123711]
BS, BSS [0.13162236223123655, 0.07124818732814608]
数据集 6 测试集TSS: 0.6087628865979382
Namespace(batch_size=16, cuda=True, datasetname='data筛选', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM_new', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
./data筛选/7Test.csv每一类的数量是: [3640, 840]
./data筛选/7Test.csvget_Class函数得到的的权重： [0.6153846153846154, 2.6666666666666665]
./data筛选/7Test.csv每一类的数量是: [3640, 840]
./data筛选/7Test.csvget_Class函数得到的的权重： [0.6153846153846154, 2.6666666666666665]
./data筛选/7Test.csv每一类的数量是: [3640, 840]
./data筛选/7Test.csvget_Class函数得到的的权重： [0.6153846153846154, 2.6666666666666665]
(4480, 10)
(112, 40, 10)
(4480, 1)
(112,)
(4480, 1)
(112,)
(4480, 1)
(112,)
zero: 0.6153846153846154
zero: 2.6666666666666665
{0.0: 0.6153846153846154, 1.0: 2.6666666666666665}
====================数据集7测试集轮评估数据=============================================
[[83  8]
 [ 7 14]]
TSS: 0.5787545787545787
本轮评估完成 
Test set: Average loss: 7.4339, Accuracy: 97/112 (87%)

[[83  8]
 [ 7 14]]
Recall [0.91208791 0.66666667]
Precision [0.92222222 0.63636364]
Accuracy [0.86607143 0.86607143]
TSS [0.57875458 0.57875458]
HSS [0.56834532 0.56834532]
FAR [0.07777778 0.36363636]
data_FPR [0.33333333 0.08791209]
BS, BSS [0.1432829620739986, 0.05947594125785538]
数据集 7 测试集TSS: 0.5787545787545787
Namespace(batch_size=16, cuda=True, datasetname='data筛选', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM_new', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
./data筛选/8Test.csv每一类的数量是: [3440, 640]
./data筛选/8Test.csvget_Class函数得到的的权重： [0.5930232558139535, 3.1875]
./data筛选/8Test.csv每一类的数量是: [3440, 640]
./data筛选/8Test.csvget_Class函数得到的的权重： [0.5930232558139535, 3.1875]
./data筛选/8Test.csv每一类的数量是: [3440, 640]
./data筛选/8Test.csvget_Class函数得到的的权重： [0.5930232558139535, 3.1875]
(4080, 10)
(102, 40, 10)
(4080, 1)
(102,)
(4080, 1)
(102,)
(4080, 1)
(102,)
zero: 0.5930232558139535
zero: 3.1875
{0.0: 0.5930232558139535, 1.0: 3.1875}
====================数据集8测试集轮评估数据=============================================
[[78  8]
 [ 2 14]]
TSS: 0.7819767441860465
本轮评估完成 
Test set: Average loss: 5.9870, Accuracy: 92/102 (90%)

[[78  8]
 [ 2 14]]
Recall [0.90697674 0.875     ]
Precision [0.975      0.63636364]
Accuracy [0.90196078 0.90196078]
TSS [0.78197674 0.78197674]
HSS [0.67843632 0.67843632]
FAR [0.025      0.36363636]
data_FPR [0.125      0.09302326]
BS, BSS [0.11011267674380996, 0.1674329296202045]
数据集 8 测试集TSS: 0.7819767441860465
Namespace(batch_size=16, cuda=True, datasetname='data筛选', dropout=0.5, embed='timeF', embed_dim=100, epochs=160, hidden_units=256, log_interval=100, lr=0.001, model_type='LSTM_new', num_dataset=9, num_heads=5, num_hidden_layers=4, num_layers=2, optim='Adam', print=1, seed=2021)
./data筛选/9Test.csv每一类的数量是: [3400, 840]
./data筛选/9Test.csvget_Class函数得到的的权重： [0.6235294117647059, 2.5238095238095237]
./data筛选/9Test.csv每一类的数量是: [3400, 840]
./data筛选/9Test.csvget_Class函数得到的的权重： [0.6235294117647059, 2.5238095238095237]
./data筛选/9Test.csv每一类的数量是: [3400, 840]
./data筛选/9Test.csvget_Class函数得到的的权重： [0.6235294117647059, 2.5238095238095237]
(4240, 10)
(106, 40, 10)
(4240, 1)
(106,)
(4240, 1)
(106,)
(4240, 1)
(106,)
zero: 0.6235294117647059
zero: 2.5238095238095237
{0.0: 0.6235294117647059, 1.0: 2.5238095238095237}
====================数据集9测试集轮评估数据=============================================
[[71 14]
 [ 2 19]]
TSS: 0.7400560224089636
本轮评估完成 
Test set: Average loss: 6.1125, Accuracy: 90/106 (85%)

[[71 14]
 [ 2 19]]
Recall [0.83529412 0.9047619 ]
Precision [0.97260274 0.57575758]
Accuracy [0.8490566 0.8490566]
TSS [0.74005602 0.74005602]
HSS [0.60903642 0.60903642]
FAR [0.02739726 0.42424242]
data_FPR [0.0952381  0.16470588]
BS, BSS [0.11717239401272435, 0.2624375242986159]
数据集 9 测试集TSS: 0.7400560224089636
#接下来计算所有测试集指标均值和方法
[[784 103]
 [ 32 162]]
[[0.14116690568564966, 0.04433107420170879], [0.16158653395184916, -0.20432995120638764], [0.12351293426702357, 0.11729114580327515], [0.10552545457221285, 0.3673152346712558], [0.09312735582217682, 0.3242215335721793], [0.16777079252785915, -0.04856745329911938], [0.13162236223123655, 0.07124818732814608], [0.1432829620739986, 0.05947594125785538], [0.11011267674380996, 0.1674329296202045], [0.11717239401272435, 0.2624375242986159]]
结果已写入 ./model_output/2025-05-07-20-30-43/results.xlsx
程序运行时间: 0.15 分钟
